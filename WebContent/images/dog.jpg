<!DOCTYPE html>
<html lang="ko-KR" >
<head>
    <!-- meta -->
    <meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=0"/>
<meta name="referrer" content="unsafe-url">

<!-- google ad sence -->
<script data-ad-client="ca-pub-2704741335862169" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<link rel="icon" href="/images/favicon.ico" type="image/x-icon">
<!-- // meta -->

    <!-- header-script -->
    <link rel="stylesheet" href="/css/lib/ion.rangeSlider.min.css">
<link rel="stylesheet" href="/css/lib/datepicker.min.css">
<link rel="stylesheet" href="/css/style_mobile.css?ver=3.0.8">

<script src="/js/lib/jquery-3.4.1.min.js"></script>
<script src="/js/lib/jquery-ui.min.js"></script>
<script src="/js/lib/jquery.cookie.min.js"></script>
<script src="/js/lib/lazysizes.min.js" async=""></script>
<script src="/js/lib/moment.min.js"></script>
<script src="/js/lib/modernizr-custom.js"></script>
<script src="/js/lib/detectizr.min.js"></script>
<script src="/js/vendor.js"></script>
<script src="/js/common.js?ver=3.0.8"></script>
<script src="/js/lib/hangul.min.js" type="text/javascript"></script>

<link rel="stylesheet" href="https://uicdn.toast.com/tui.chart/latest/tui-chart.min.css">
<script src="https://uicdn.toast.com/tui.chart/latest/tui-chart-all.min.js"></script>
<script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=xuh6ou62fp"></script>
<!-- bottom popup -->
<div class="floating-items">
    <!-- popup-floating -->
    <section id="toast-last-read-news" class="popup-floating floating-relay">
        <div class="breaking-news">
            <div class="white-badge">이어보기</div>
            <a class="text" href="javascript:;" id="toast-last-read-a-tag"></a>
            <button class="btn-close" onclick="onClickCloseLastReadNews()">
                <span class="blind">닫기</span>
            </button>
        </div>
    </section>

    <!-- popup-floating -->
    <section id="floating-ad" class="popup-floating floating-ad">
    <!-- .ad-banner -->
    <div class="ad-banner">
        <div class="img-box">
            <script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/endpage@floating"></script>
        </div>
    </div>
    <!-- // .ad-banner -->
    <button class="btn-close-small" onclick="onAdCloseClick()">
        <span class="blind">닫기</span>
    </button>
</section>

<script>

    function onAdCloseClick() {
        $('#floating-ad').closePopup();
    }

    $(document).ready(function() {
        $('#floating-ad').openPopup(); // 플로팅광고
        // 안드로이드 앱 : youtube frame 있는경우 하단 플로팅 광고 제거
        if(navigator.userAgent.indexOf('Mobile-App-Android') > -1){
            if($("iframe[src*='youtube.com']").length>0){
                $('#floating-ad').addClass('blind');
            }
        }
    });
</script>
<!-- FCM script -->
    <div class="toast-container imp-toast">
    <!-- 로그인/회원가입 -->
    <div class="toast-item login-box-tst">
        <div class="toast-inner clearfix">
            <div class="tit">
                <p><a href="/Intro/Intro2022">새로워진 한국일보를 만나세요.</a></p>
            </div>
            <a href="/auth/sign-in" class="more-txt">로그인</a>
            <a href="javascript:void(0);" class="close a11y" onclick="fnOneDayNotView()">닫기</a>
        </div>
    </div>
</div>

<script type="text/javascript">
    let $loginBox = $('.toast-container .toast-item.login-box-tst');
    let PUSH_TYPE = {
      SOKBO : {
        class: "sokbo-mark",
        name: "속보"
      },
      EXCLUSIVE : {
        class: "exclusive-mark",
        name: "단독"
      },
      SUBSCRIBE : {
        class: "subscribe-mark",
        name: "구독"
      },
      REACTION : {
        class: "reaction-mark",
        name: "공감"
      },
      COMMON : {
        class: "common-mark",
        name: "주요"
      },
      NOTICE : {
        class: "notice-mark",
        name: "공지"
      },
      EVENT : {
        class: "event-mark",
        name: "알림"
      },
      REPLY : {
        class: "reply-mark",
        name: "답글"
      },
      REPLY_RE : {
        class: "reply-re-mark",
        name: "댓글"
      },
      RECOMMEND : {
        class: "recommend-mark",
        name: "추천"
      }
    };

    generateSokboToast = (redisJson) => {
        let readArticles = decodeURIComponent(this.getFCMCookie('hk_sokbo_article_viewend'));
        let denialAlarmType = decodeURIComponent(this.getFCMCookie('hk_denial_alarm_type'));
        for (var i = 0; i < redisJson.articles.length; i++){
            const expire_time = moment(redisJson.articles[i].expire_time, 'YYYY-MM-DD hh:mm:ss').format('YYYY-MM-DD hh:mm:ss');
            const now = moment().format('YYYY-MM-DD hh:mm:ss');
            const isNowDeploy = moment(expire_time).isAfter(now);

            if(!isNowDeploy){
                return false;
            }
            if(readArticles.includes(redisJson.articles[i].article_id) || denialAlarmType.includes(redisJson.articles[i].article_type)){
                break;
            }

            let html = '';
            html += '<div class="toast-item"  data-push-id="'+ redisJson.articles[i].apppush_Id +'">';
            html += '    <div class="toast-inner-wrapper">';
            html += '        <div class="title">';

            if(Object.keys(PUSH_TYPE).indexOf(redisJson.articles[i].article_type) > -1){
                html += '            <span class="badge '+ PUSH_TYPE[redisJson.articles[i].article_type].class +'">'+ PUSH_TYPE[redisJson.articles[i].article_type].name +'</span>';
            }
            if(redisJson.articles[i].article_title.trim() !== "한국일보"){
                if(redisJson.articles[i].article_type === "REPLY_RE"){
                    html += '       <h4 class="title-text"><a href="/webpool-click/?i='+redisJson.articles[i].apppush_Id+'&c='+redisJson.articles[i].article_id+'">' + redisJson.articles[i].article_title.replace("댓글 10개", "<strong>댓글 10개</strong>") + '</a></h4>';
                }else if(redisJson.articles[i].article_type === "REACTION"){
                    html += '       <h4 class="title-text"><a href="/webpool-click/?i='+redisJson.articles[i].apppush_Id+'&c='+redisJson.articles[i].article_id+'">' + redisJson.articles[i].article_title.replace("공감 10개", "<strong>공감 10개</strong>") + '</a></h4>';
                }else if(redisJson.articles[i].article_type === "REPLY" ){
                    html += '       <h4 class="title-text"><a href="/webpool-click/?i='+redisJson.articles[i].apppush_Id+'&c='+redisJson.articles[i].article_id+'">' + redisJson.articles[i].article_title.replace("답글", "<strong>답글</strong>") + '</a></h4>';
                }else {
                    html += '       <h4 class="title-text"><a href="/webpool-click/?i='+redisJson.articles[i].apppush_Id+'&c='+redisJson.articles[i].article_id+'">' + redisJson.articles[i].article_title + '</a></h4>';
                }
            }

            if(Object.keys(PUSH_TYPE).indexOf(redisJson.articles[i].article_type) > -1){
                html += '            <a href="/webpool-click/?i='+redisJson.articles[i].apppush_Id+'&c='+redisJson.articles[i].article_id+'"><p>' + redisJson.articles[i].article_contents.replace(new RegExp("\\["+ PUSH_TYPE[redisJson.articles[i].article_type].name +"\\]" , "g"), "") + '</p></a>';
            } else {
                html += '            <a href="/webpool-click/?i='+redisJson.articles[i].apppush_Id+'&c='+redisJson.articles[i].article_id+'"><p>' + redisJson.articles[i].article_contents + '</p></a>';
            }

            html += '        </div>'

            if(redisJson.articles[i].article_image !== '' || redisJson.articles[i].article_image !== null){
                html += '           <div class="img-box">';
                html += '               <img src="' + redisJson.articles[i].article_image + '" alt="">';
                html += '           </div>';
            }

            html += '    </div>';
            html += '    <div class="actions">';
            html += '        <button type="button" class="btn-alarm" title="오늘 하루 알림 끄기" data-denial="' + redisJson.articles[i].article_type +'">알림설정</button>';
            html += '        <button type="button" class="btn-close">알림 닫기</button>';
            html += '    </div>';
            html += '</div>';
            $loginBox.after(html);
            autoRemoveToast(redisJson.articles[i].apppush_Id);

            // 만료시간체크 : 존재하면 내용 분석하여 만료시간이 현재시간이내이면 노출
            // 쿠키노출체크 : 노출할경우 쿠키에 해당 기사 노출확인후 최종 노출
            // 노출한 경우 해당기사키 쿠키에 저장
            // 쿠키명 : hk_sokbo_article_viewend
            let fcmArticleId = getFCMCookie('hk_sokbo_article_viewend');
            let cookieData = Boolean(fcmArticleId) ? decodeURIComponent(fcmArticleId) + ',' + redisJson.articles[i].article_id : redisJson.articles[i].article_id;
            this.setFCMCookie('hk_sokbo_article_viewend', cookieData, 1);
            // 쿠키내용 : 기사키,기사키,기사키
            // 쿠키만료시간 : 1일
            // 쿠키 등록
        }
        $(".toast-container .toast-item:not(.login-box-tst)").addClass("show");

    }

    generateFcmToast = (rst) => {
        let html = '';
        let readArticles = decodeURIComponent(this.getFCMCookie('hk_sokbo_article_viewend'));
        let denialAlarmType = decodeURIComponent(this.getFCMCookie('hk_denial_alarm_type'));
        if(denialAlarmType.includes(denialAlarmType.includes(rst.data.apppush_type))){
            return false;
        }
        if(readArticles.includes(denialAlarmType.includes(rst.data.apppush_type))){
            return false;
        }
        const appuserPushId = Cookies.get('appuserPushId');

        html += '<div class="toast-item" data-push-id="'+ rst.fcmMessageId +'">';
        html += '    <div class="toast-inner-wrapper">';
        html += '        <div class="title">';


        if(Object.keys(PUSH_TYPE).indexOf(rst.data.apppush_type) > -1){
            html += '            <span class="badge '+ PUSH_TYPE[rst.data.apppush_type].class +'">'+ PUSH_TYPE[rst.data.apppush_type].name +'</span>';
        }

        if(rst.notification.title.trim() !== "한국일보"){
            if(rst.data.apppush_type === "REPLY_RE"){
                html += '       <h4 class="title-text"><a href="'+ rst.data.uri + '&a=' + appuserPushId +'">' + rst.notification.title.replace("댓글 10개", "<strong>댓글 10개</strong>") + '</a></h4>';
            }else if(rst.data.apppush_type === "REACTION"){
                html += '       <h4 class="title-text"><a href="'+ rst.data.uri + '&a=' + appuserPushId +'">' + rst.notification.title.replace("공감 10개", "<strong>공감 10개</strong>") + '</a></h4>';
            }else if(rst.data.apppush_type === "REPLY" ){
                html += '       <h4 class="title-text"><a href="'+ rst.data.uri + '&a=' + appuserPushId +'">' + rst.notification.title.replace("답글", "<strong>답글</strong>") + '</a></h4>';
            }else{
                html += '       <h4 class="title-text"><a href="'+ rst.data.uri + '&a=' + appuserPushId +'">' + rst.notification.title + '</a></h4>';
            }
        }

        if(Object.keys($PUSH_TYPE).indexOf(rst.data.apppush_type) > -1){
            html += '            <a href="'+ rst.data.uri + '&a=' + appuserPushId +'"><p>' + rst.notification.body.replace(new RegExp("\\["+ $PUSH_TYPE[rst.data.apppush_type].name +"\\]" , "g"), "") + '</p></a>';
        } else {
            html += '            <a href="'+ rst.data.uri + '&a=' + appuserPushId +'"><p>' + rst.notification.body + '</p></a>';
        }

        html += '        </div>';

        if(rst.notification.image !== '' || rst.notification.image !== null){
            html += '            <div class="img-box">';
            html += '                <img src="' + rst.notification.image + '" alt="">';
            html += '            </div>';
        }

        html += '    </div>';
        html += '    <div class="actions">';
        html += '        <button type="button" class="btn-alarm" title="오늘 하루 알림 끄기" data-denial="' + rst.data.apppush_type +'">알림설정</button>';
        html += '        <button type="button" class="btn-close">알림 닫기</button>';
        html += '    </div>';
        html += '</div>';
        $loginBox.before(html);
        autoRemoveToast(rst.fcmMessageId);
        // 만료시간체크 : 존재하면 내용 분석하여 만료시간이 현재시간이내이면 노출
        // 쿠키노출체크 : 노출할경우 쿠키에 해당 기사 노출확인후 최종 노출
        // 노출한 경우 해당기사키 쿠키에 저장
        // 쿠키명 : hk_sokbo_article_viewend
        // let fcmArticleId = getFCMCookie('hk_sokbo_article_viewend');
        // let cookieData = Boolean(fcmArticleId) ? decodeURIComponent(fcmArticleId) + ',' + redisJson.articles[i].article_id : redisJson.articles[i].article_id;
        // this.setFCMCookie('hk_sokbo_article_viewend', cookieData, 1);
        // 쿠키내용 : 기사키,기사키,기사키
        // 쿠키만료시간 : 1일
        // 쿠키 등록
        $(".toast-container .toast-item:not(.login-box-tst)").addClass("show");
    }

    /* top notice EVT */
    function closeNotice() {
        $("#topNotiArea .close").on('click', function () {
            $("#topNotiArea .close").css("display", "none");
            $("#topNotiArea").slideUp(500);
        });
    }

    function initAlarm() {
        var $list = $('.toast-container .toast-item');
        var $pushList = $('.toast-container .toast-item:not(.login-box-tst)');
        var $loginBox = $('.toast-container .toast-item.login-box-tst');

        if ($($list.hasClass("login-box-tst")).length) {
            $loginBox.removeClass("hide").addClass("show");
        }
        $pushList.each(function (idx) {
            var $item = $(this);
            setTimeout(function () {
                $item.addClass("show");
            }, 500 * (idx + 1));
        });
    }

    function showAlarm() {
        let redisJson = [];

        $.ajax({
            url: "https://api.hankookilbo.com/api/readredis",
            method: "POST",
            data: {'key' : 'whk_sokbo_article'},
            success: function (response) {
                if(response.code === '0000'){
                    if(response.data !== 'notfound'){
                        redisJson = JSON.parse(response.data);
                        generateSokboToast(redisJson);
                    }
                }
            },
            fail: function (err) {
            }
        });
    }
    // hk_denial_alarm_type
    function setDenialAlarmType(denialType){
        this.setFCMCookie('hk_denial_alarm_type', denialType, 1);
    }

    function getFCMCookie(key){
        key = new RegExp(key + '=([^;]*)');
        return key.test(document.cookie) ? unescape(RegExp.$1) : ''; // 인자로 받은 키에 해당하는 키가 있으면 값을 반환
    }

    function setFCMCookie(key, value, expiredays) {
        let todayDate = new Date();
        todayDate.setDate(todayDate.getDate() + expiredays); // 현재 시각 + 일 단위로 쿠키 만료 날짜 변경
        //todayDate.setTime(todayDate.getTime() + (expiredays * 24 * 60 * 60 * 1000)); // 밀리세컨드 단위로 쿠키 만료 날짜 변경
        document.cookie = key + "=" + escape(value) + "; path=/; expires=" + todayDate.toGMTString() + ";";
    }

    function deleteCookie(name) {
        document.cookie = name + '=; expires=Thu, 01 Jan 1999 00:00:10 GMT;';
    }

    function hideAlarm() {
        $(document).on("click", '.imp-toast .btn-close', function () {
            var $this = $(this);
            $this.parents(".toast-item").removeClass("show").addClass("hide");
        });

        $(document).on("click", '.login-box-tst .close', function () {
            $('.login-box-tst').removeClass("show").addClass("hide");
        });
    }

    function toggleAlarm() {
        $(document).on("click", '.imp-toast .btn-alarm', function () {
            var $this = $(this);
            if (!($this.hasClass("btn-alarm-disable"))) {
                $this.addClass("btn-alarm-disable").attr("title", "오늘 하루 알림 켜키");
                console.log('### ' + $this.data('denial'));
                let denialType = $this.data('denial');

                let hk_denial_alarm_type = getFCMCookie('hk_denial_alarm_type');
                if(hk_denial_alarm_type.includes(denialType)) {
                    return false;
                }
                denialType = Boolean(hk_denial_alarm_type) ? decodeURIComponent(hk_denial_alarm_type) + ',' + denialType : denialType;
                setDenialAlarmType(denialType);
            } else {
                $this.removeClass("btn-alarm-disable").attr("title", "오늘 하루 알림 끄기");
                let hk_denial_alarm_type = getFCMCookie('hk_denial_alarm_type');
                const denialType = $this.data('denial');

                if(hk_denial_alarm_type.includes(denialType)){
                    let str = hk_denial_alarm_type;
                    let arr = str.split(',');
                    let filtered = arr.filter((element) => element !== denialType);
                    deleteCookie('hk_denial_alarm_type');
                    setDenialAlarmType(filtered.join());
                }


                // console.log(denialType);
                // deleteCookie(hk_denial_alarm_type);
            }
        });
    }

    function fnOneDayNotView(){
        this.setFCMCookie('hk_denial_login_area', 'Y', 1);
    }

    function loginInfoView(){
        if(!Boolean(Cookies.get('accessToken'))){
            if(!Boolean(getFCMCookie('hk_denial_login_area'))){
                var $loginBox = $('.toast-container .toast-item.login-box-tst');
                $loginBox.removeClass("hide").addClass("show");
            }
        }
    }

    // 웹푸시 자동삭제(10분)
    var FCM_TOAST_LOG = {};
    function autoRemoveToast(fcmMessageId){
        FCM_TOAST_LOG[fcmMessageId] = setTimeout(function(){
            $(".toast-item[data-push-id='"+ fcmMessageId +"']").find('.btn-close').trigger("click");
            delete FCM_TOAST_LOG[fcmMessageId];
        }, 600000);
    };

    $(function () {
        showAlarm();
        // 상단 탑 노티영역 닫기
        closeNotice();
        loginInfoView();

        // 푸시알람 표시
        // initAlarm();
        // 속보 / 단건 조회
        setInterval(
            () =>
            showAlarm()
            , 1000 * 60 * 1
        );

        // 푸시알람 닫기, 알람끄기 토글
        hideAlarm();
        toggleAlarm();
    });
</script>


</div>

<script src="/js/article-notice.js"></script>

<script>
    /**
     * 로그인 돼있으면
     */
    // if (Cookies.get('accessToken')) {
    //     // console.log('이어보기 기사 id 조회');
    //     $.ajax({
    //         url: '/users/last-read-article',
    //         type: 'GET',
    //         contentType: 'application/json',
    //         timeout: 30000,
    //         success: function (data) {
    //             // // console.log(data);
    //             if (data) {
    //                 // console.log('이어보기 기사 있음');
    //                 $('#toast-last-read-news').addClass('on');
    //                 $('#toast-last-read-news').addClass('show');
    //                 $('#toast-last-read-news').removeClass('blind');
    //                 $('#toast-last-read-a-tag').html(data.articleTitle);
    //
    //                 $('#toast-last-read-a-tag').on('click', function() {
    //                     removeLastReadArticle();
    //                     location.href = '/News/Read/' + data.articleId;
    //                 });
    //                 // console.log(data)
    //             } else {
    //                 // console.log('이어보기 기사 없음');
    //                 // console.log(data);
    //             }
    //         },
    //         error: function (req, stat, err) {
    //             // console.log(err);
    //         }
    //     }); // ajax
    // }

    function onClickCloseLastReadNews() {
        $('#toast-last-read-news').addClass('blind');
        removeLastReadArticle()
    }
</script>
<!-- // bottom popup -->

<script>
    // 기본 이미지
    (function(){
        var NOTFOUNDSRC = '/images/Default-Image.png';
        document.addEventListener('error', function(e){
            // image 404
            if(e.target.nodeName.toLowerCase() == 'img' && e.target.getAttribute('src') != NOTFOUNDSRC){
                e.target.src = NOTFOUNDSRC;
            }
        }, true);
    })();

    // 기사 닫기 클릭 시 돌아갈 url 정의
    if ('' != 'MAIN') {
        
        Cookies.set('closeUrl', '/', { path: '/' });
        
    }

    // CDN 제외 설정
    $.ajaxSetup({
        beforeSend : function(xhr){
            xhr.setRequestHeader("Cache-Control", "no-cache");
        }
    });

    // var updateFlag = false;

    // 체류시간
    // document.cookie = 'uv_stay_id' + "=" + generateUuid() + "; path=/";
    var stayId = generateUuid();

    // 방문자
    if (!Cookies.get('uv_user_id')) {
        var date = new Date();
        // 아이폰일 경우
        // if (navigator.userAgent.indexOf('iPhone') > -1 || navigator.userAgent.indexOf('Mobile-App-Ios') > -1 ) {
        //     date.setHours(date.getHours() - 9);
        // }

        date.setFullYear(date.getFullYear() + 1);

        var expireDate = new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);
        var expires = "; expires=" + expireDate.toUTCString();

        document.cookie = 'uv_user_id' + "=" + generateUuid() + expires + "; path=/";
        // updateFlag = true;
    }

    // 세션
    if (!Cookies.get('uv_session_id')) {
        var date = new Date();
        // 아이폰일 경우
        // if (navigator.userAgent.indexOf('iPhone') > -1 || navigator.userAgent.indexOf('Mobile-App-Ios') > -1 ) {
        //     date.setHours(date.getHours() - 9);
        // }

        date.setTime(date.getTime() + (30 * 1000 * 60));
        var expires = "; expires=" + date.toUTCString();

        
        document.cookie = 'uv_session_id' + "=" + generateUuid() + "; path=/";
        // updateFlag = true;

        // 로그인 flag
        loggedIn = Cookies.get('accessToken');
        refreshToken = Cookies.get('refreshToken');
        if(loggedIn == undefined && refreshToken != undefined){
            $.ajax({
                url: '/auth/auto_login',
                type: 'POST',
                data: JSON.stringify({
                    autoLoginFlag: true
                }),
                contentType: 'application/json',
                timeout: 100000,
                success: function (data) {
                    location.reload();
                },
                error : function(err){
                    console.log(err);
                }
            });
        }
    }


    $(function (){
        if($(".dimmed").length==0){
            $("body").prepend("<div class=\"dimmed\"></div>");
        }
    });
</script>

<script src="https://www.gstatic.com/firebasejs/7.13.2/firebase.js"></script>
<script>

    const isMobileChrome = (-1 !== navigator.userAgent.indexOf('Chrome'));
    if (isMobileChrome) {
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyCj96NqzMc42ZMLCv4GqbnKErMsqalgUng",
            authDomain: "hankookilbo-25efe.firebaseapp.com",
            databaseURL: "https://hankookilbo-25efe.firebaseio.com",
            projectId: "hankookilbo-25efe",
            storageBucket: "hankookilbo-25efe.appspot.com",
            messagingSenderId: "115606840922",
            appId: "1:115606840922:web:93245197d8f8586d46da63",
            measurementId: "G-2RZDGBVQK4"

        };
        firebase.initializeApp(config);

        const messaging = firebase.messaging();

        //token값 알아내기
        messaging.requestPermission()
            .then(function () {
                console.log("Have permission");
                return messaging.getToken();
            })
            .then(function (token) {
                Cookies.set('FCM-TOKEN', token, {path: '/'});
                // const cft = Cookies.get('FCM-TOKEN');
                // if(!Boolean(cft)){
                // Cookies.set('fid', guid(), {path: '/'});
                var appuserPushId = Cookies.get('appuserPushId');
                fcmLoading(appuserPushId, token);
                // }

            })
            .catch(function (arr) {
                console.log("Error Occured");
            });

        messaging.onMessage((payload) => {
            console.log('Message received. ', payload);
            generateFcmToast(payload);
            // ...
        });

        function fcmLoading(appuserPushId, token) {
            if (Boolean(appuserPushId)) {
                data = {
                    'appuserPushId': appuserPushId
                    , 'appuserPushKey': token
                };
            } else {
                data = {
                    'appuserPushId': appuserPushId
                    , 'appuserPushKey': token
                    , 'appuserPushAgreeyn': 'Y'
                    , 'appuserAlarmSokbo': 'Y'
                    , 'appuserAlarmSubscribe': 'Y'
                    , 'appuserAlarmReply': 'Y'
                    , 'appuserAlarmMarketing': 'Y'
                    , 'appuserAlarmEtiquetteTime': 'Y'
                };
            }
            $.ajax({
                url: '/main-fcm-loading',
                method: 'GET',
                dataType: 'json',
                contentType: 'application/json',
                data: data,
                success: function (response) {
                    if (response.code === '0000') {
                        var expDate = new Date();
                        expDate.setTime(expDate.getTime() + (60*60*24*365 * 1000));
                        Cookies.set('appuserPushId', response.data.view.appuserPushId, {path: '/', expires: expDate});
                    }
                },
                fail: function (response) {
                }
            });
        }
    }
</script>
<!-- // header-script -->

    <!-- seo -->
    <script>
    window.dataLayer = window.dataLayer || [];

    if (Cookies.get('accessToken') !== undefined) {
        $.ajax({
            url: '/google-analytics/user-details-decrypt',
            type: 'GET',
            contentType: 'application/json',
            success: function (data) {
                dataLayer.push({
                    'event': 'user_details',
                    'user_id': data.user_id,
                    'gender': data.gender,
                    'yob': data.yob,
                    'join_date': data.join_date,
                    'join_type': data.join_type,
                    'subs': data.subs,
                    'pan_setting': data.pan_setting,
                    'agree_email': data.agree_email,
                    'agree_sms': data.agree_sms,
                    'agree_newsletter': data.agree_newsletter,
                    'agree_push': data.agree_push,
                });
            },
            error: function () {
            }
        });
    }

</script>

<!-- GA4 pageView -->
<script>
    window.dataLayer = window.dataLayer || [];
    dataLayer.push({
        
                'event': 'article_view',
            
                'headline': '개는 진짜로 웃는 걸까',
                'article_id': '201512171111528240',
                
                    'content_category': '라이프',
                    'content_subcategory': '라이프일반',
                
                'article_type': '',
                'article_length': '',
                'author_id':'',
                'author_name': '',
                'first_puble_date': '2015/12/17',
                'first_puble_time': '11:00:00',
                'last_puble_date': '2015/12/17',
                'last_puble_time': '11:00:00',
                'feature_type': '',
                'article_tags': ''
            
    });
</script>

<!-- Google Tag Manager -->
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];
        w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
        j.async=true;
        j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
        f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5G989SBV');
</script>
<!-- End Google Tag Manager -->

<!-- GA4 clickInArticle -->
<script>
    window.dataLayer = window.dataLayer || [];
    dataLayer.push({
        'event': 'click_in_article',
        
                'page_type': 'article',
            
                'headline': '개는 진짜로 웃는 걸까',
                'article_id': '201512171111528240',
                
                    'content_category': '라이프',
                    'content_subcategory': '라이프일반',
                
                'article_type': '',
                'article_length': '',
                'author_id':'',
                'author_name': '',
                'first_puble_date': '2015/12/17',
                'first_puble_time': '11:00:00',
                'last_puble_date': '2015/12/17',
                'last_puble_time': '11:00:00',
                'feature_type': '',
                'article_tags': ''
            
    });
</script>

<meta name="title" content="개는 진짜로 웃는 걸까">
        <meta name="keywords" content="">
        <meta name="description" content=" - ">
        <meta name="headline" content="개는 진짜로 웃는 걸까">
        <meta name="content_category" content="라이프">
            <meta name="content_subcategory" content="라이프일반">
        <meta name="content_category" content="동물">
            <meta name="content_subcategory" content="동물">
        <meta name="article_type" content="">
        <meta name="article_length" content="">

        <meta property="og:url" content="https://m.hankookilbo.com/News/Read/201512171111528240?t=20230807194001">
        <meta property="og:site_name" content="한국일보">
        <meta property="og:locale" content="ko_KR">
        <meta property="og:type" content="article" >
        <meta property="og:title" content="개는 진짜로 웃는 걸까" >
        <meta property="og:description" content="" >

        <meta property="og:image" content="https://newsimg.hankookilbo.com/cms/articlerelease/201512171111528240_1.jpg?t=20230807194001" >
        <meta property="og:image:width" content="1200">
        <meta property="og:image:height" content="630">

        <meta property="article:author" content="https://www.facebook.com/hkilbo">
        <meta property="article:publisher" content="https://www.facebook.com/hkilbo">


        <meta name="twitter:site" content="@hankookilbo" >
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:url" content="https://m.hankookilbo.com/News/Read/201512171111528240?t=20230807194001">
        <meta name="twitter:title" content="개는 진짜로 웃는 걸까" >
        <meta name="twitter:description" content="" >
        <meta name="twitter:image" content="https://newsimg.hankookilbo.com/cms/articlerelease/201512171111528240_1.jpg?t=20230807194001" >
        <meta name="twitter:creator" content="@hankookilbo">

        <meta property="article:published_time" content="2015-12-17T11:00:00.000+0900">
        <meta property="article:section" content="라이프">
            <meta property="article:section2" content="라이프일반">
        <meta property="article:section" content="동물">
            <meta property="article:section2" content="동물">
        <meta property="article:section3" content="애니아티클">
        <meta property="dable:item_id" content="201512171111528240">
            <meta property="dable:author" content="">
            <meta property="dable:title" content="개는 진짜로 웃는 걸까">
            <meta property="dable:image" content="https://newsimg.hankookilbo.com/cms/articlerelease/201512171111528240_1.jpg?t=20230807194001">
        <meta name="robots" content="max-image-preview:large">
<meta property="fb:pages" content="157370204315766" >
<link rel="canonical" href="https://m.hankookilbo.com/News/Read/201512171111528240">

<title>개는 진짜로 웃는 걸까</title>
<!-- // seo -->

    <script data-ad-client="ca-pub-9575884151581415" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2926858550121041" crossorigin="anonymous"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script>
        var _searchHost = '';
        try{
            _searchHost = 'https://search.hankookilbo.com';
        }catch(e){
            _searchHost = 'https://search.hankookilbo.com';
        }
    </script>

    <!-- taboola -->
    <script type="text/javascript">
        window._taboola = window._taboola || [];
        _taboola.push({article:'auto'});
        !function (e, f, u, i) {
            if (!document.getElementById(i)){
                e.async = 1;
                e.src = u;
                e.id = i;
                f.parentNode.insertBefore(e, f);
            }
        }(document.createElement('script'),
            document.getElementsByTagName('script')[0],
            '//cdn.taboola.com/libtrc/hankookilbo-mobile/loader.js',
            'tb_loader_script');
        if(window.performance && typeof window.performance.mark == 'function')
        {window.performance.mark('tbl_ic');}
    </script>
<!-- Dable 스크립트 시작 / 문의 media@dable.io -->
<script>
    (function(d,a,b,l,e,_) {
        d[b]=d[b]||function(){(d[b].q=d[b].q||[]).push(arguments)};e=a.createElement(l);
        e.async=1;e.charset='utf-8';e.src='//static.dable.io/dist/plugin.min.js';
        _=a.getElementsByTagName(l)[0];_.parentNode.insertBefore(e,_);
    })(window,document,'dable','script');
    dable('setService', 'm.hankookilbo.com');
    dable('sendLogOnce');
</script></head>

<!-- GA4 articleComplete -->
<script>
    window.dataLayer = window.dataLayer || [];
    dataLayer.push({
        'event': 'article_complete',
        
        'page_type': 'article',
        
        'headline': '개는 진짜로 웃는 걸까',
        'article_id': '201512171111528240',
        
        'content_category': '라이프',
        'content_subcategory': '라이프일반',
        
        'article_type': '',
        'article_length': '',
        'author_id':'',
        'author_name': '',
        'first_puble_date': '2015/12/17',
        'first_puble_time': '11:00:00',
        'last_puble_date': '2015/12/17',
        'last_puble_time': '11:00:00',
        'feature_type': '',
        'article_tags': ''
    });
</script>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5G989SBV"
            height="0" width="0" style="display:none;visibility:hidden">
    </iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->
<!-- wrap -->
<div class="wrap improve">
    <!-- top -->
    <!-- header -->
<div class="improve-header" data-type="end">
    <div class="top-bar">
        <div class="navigate">
            <a href="#" class="icon-btn-back" onclick="history.back();">이전페이지</a>
            </div>

        <div class="actions">
            <button type="button" class="icon-btn-share">공유하기</button>
            <button type="button" class="icon-btn-bookmark" onclick="onClickSaveArticleBtn()">저장하기</button>
            <button type="button" class="icon-btn-comment">
                댓글작성
                <span class="count" id="commentCntSpan">
              <span class="blind" >새로운 댓글</span>
              6
            </span>
            </button>
            <button type="button" class="icon-btn-viewmode">글자크기 조절</button>
        </div>
    </div>

    <div class="toolbox">
        <div class="scale">
            <div class="scale-min">가</div>
            <div id="font-scale-control">
                <span class="scale-lv-Line"></span>
                <span class="scale-lv-Line"></span>
                <span class="scale-lv-Line"></span>
                <span class="scale-lv-Line"></span>
                <span class="scale-lv-Line"></span>
            </div>
            <div class="scale-max">가</div>
        </div>
        <div class="color">
            <button type="button" class="on" data-type="light">밝은 배경</button>
            <button type="button" data-type="dark">어두운 배경</button>
        </div>
    </div>
</div>

<header class="improve-header no-nav" data-type="sub">
    <div class="top-bar">
        <div class="navigate">
            <button type="button" class="icon-btn-menu" onclick="$('#gnb').openPopup('preventScroll');">
                전체메뉴
                <!-- 새로운 내용이 있을 시 추가 -->
                <!-- <i class="new"></i> -->
            </button>
            <h1 class="hk-logo"><a href="/">한국일보</a></h1>
            <button type="button" class="category">
                        라이프</button>
                </div>

        <div class="actions">
  <a href="javascript:onClickLogo()" type="button" class="icon-btn-home">홈</a>
  <button type="button" class="icon-btn-search" onclick="$('#searchPopup').openPopup();">검색</button>
  <button type="button" class="icon-btn-user" onclick="onClickMyPage()">사용자 정보</button>
</div>

<script>
  (function(){
    if (Cookies.get('accessToken') !== undefined) {
      $.ajax({
        url: '/users/push-myalarm-totalcnt',
        method: 'GET',
        success: function (response) {
          const cntNum = response.alarmTotalCount;
          if(response.code === '0000') {
            if (cntNum > 0) {
              $('#alarmBadge').show();
            } else {
              $('#alarmBadge').hide();
            }
          } else {
            $('#alarmBadge').hide();
          }
        },
        fail: function (response) {
          $('#alarmBadge').hide();
        }
      });
    }
  })();

  function onClickLogo() {
    removeLastReadArticle();
    location.replace('/');
  }

  function onClickMenuBtn() {
    // console.log(navigator.userAgent);
    if (navigator.userAgent.indexOf('Mobile-App') > -1) {
      const data = {
        type: 'OPEN_LNB'
      };
      window.ReactNativeWebView.postMessage(JSON.stringify(data));
    } else {
      $('#gnb').openPopup('preventScroll');
    }
  }
</script>
</div>

    <nav>
        <ul>
            <li class=""><a href="/News/Life/HI01">음식 </a></li>
                            <li class=""><a href="/News/Life/HI02">여행 </a></li>
                            <li class=""><a href="/News/Life/HI03">건강 </a></li>
                            <li class=""><a href="/News/Life/HI04">블론디</a></li>
                            <li class=""><a href="/News/Life/HI05">백운산 오늘의 운세</a></li>
                            <li class=""><a href="/News/Life/HI99">라이프일반</a></li>
                            </ul>
    </nav>
    </header>
<!-- // header -->

<section id="gnb" class="popup gnb">
    <!-- header -->
    <header class="header">
        <div class="left">
            <!-- .on :  알림 있는 경우 추가 -->
            <button type="button" class="btn-notice" id="btn-notice">
                <span class="blind">알림</span>
            </button>
            <button type="button" class="btn-my" onclick="onClickMyPage()">
                <span class="blind">마이페이지</span>
            </button>
        </div>
        <div class="right">
            <button type="button" class="btn-set" onclick="location.href='/users/setting'">
                <span class="blind">설정</span>
            </button>
            <button type="button" class="btn-close" onclick="$(this).closest('.popup').closePopup();">
                <span class="blind">닫기</span>
            </button>
        </div>
    </header>
    <!-- // header -->
    <!-- container -->
    <div class="container">
        <!-- top-area -->
        <div class="top-area" id="top-area">
            <p class="text" href="javascript:;">
                한국일보에 <span class="point-color">로그인</span>하시면
                <br>다양한 편의 기능을
                <br>제공 받을 수 있습니다.
            </p>
            <div class="btn-area">
                <a href="/auth/sign-in">로그인</a>
                <a href="javascript:onClickSignUp()">회원가입</a>
                <a href="/article/member-report" class="inquiry">제보 및 문의</a>
            </div>
        </div>
        <!-- // top-area -->
        <!-- nav -->
        <nav class="nav">
            <ul>
                <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/News/Politics">정치</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/Politics/HA01">국회/정당</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Politics/HA02">청와대</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Politics/HA03">외교</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Politics/HA04">국방/북한</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Politics/HA99">정치일반</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/News/Economy">경제</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/Economy/HB01">경제정책</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Economy/HB02">산업</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Economy/HB03">금융/증권</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Economy/HB04">부동산</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Economy/HB05">IT/과학</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Economy/HB99">경제일반</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/News/Society">사회</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/Society/HC01">사건/사고</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Society/HC02">법원/경찰</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Society/HC03">교육</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Society/HC04">노동</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Society/HC05">보건/복지</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Society/HC06">날씨/환경</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Society/HC99">사회일반</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/News/World">국제</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/World/HD01">아시아/호주</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/World/HD02">미국/중남미</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/World/HD03">유럽</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/World/HD04">중동/아프리카</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/World/HD05">글로벌 이슈</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/World/HD99">국제일반 </a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/News/Culture">문화</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/Culture/HE01">책</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Culture/HE02">공연/전시</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Culture/HE99">문화일반</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/News/Enter">연예</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/Culture/HF99">연예일반</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Culture/HF02">영화</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Culture/HF03">방송</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Culture/HF04">음악</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Culture/HF05">실시간 연예</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Culture/HF06">포토 뉴스</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="has-line">
                            <div class="anchor-wrap ">
                                    <a href="/Sports">스포츠</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/Sports/HG01">야구</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Sports/HG02">축구</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Sports/HG03">농구</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Sports/HG04">배구</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Sports/HG05">해외스포츠</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Sports/HG06">골프</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Sports/HG99">스포츠일반</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/News/People">사람</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/People/HH01">인터뷰 </a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/People/HH02">인사/동정</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/People/HH03">부고</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/People/HH99">사람일반</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap on">
                                    <a href="/News/Life">라이프</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/Life/HI01">음식 </a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Life/HI02">여행 </a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Life/HI03">건강 </a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Life/HI04">블론디</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Life/HI05">백운산 오늘의 운세</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Life/HI99">라이프일반</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/News/Local">지역</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/News/Local/HJ01">수도권</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Local/HJ02">대전/충청/강원</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Local/HJ03">대구/경북</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Local/HJ04">부산/경남</a>
                                            </li>
                                        <li><a class=""
                                                   href="/News/Local/HJ05">광주/전라/제주</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="">
                            <div class="anchor-wrap ">
                                    <a href="/Opinion">오피니언</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/Opinion/HK01">사설</a>
                                            </li>
                                        <li><a class=""
                                                   href="/Opinion/HK02">칼럼</a>
                                            </li>
                                        <li><a class=""
                                                   href="/Opinion/HK03">만평</a>
                                            </li>
                                        <li><a class=""
                                                   href="/Opinion/HK04">사고알림</a>
                                            </li>
                                        </ul>
                            </li>
                        <li class="has-line">
                            <div class="anchor-wrap ">
                                    <a href="/Focus">포커스 취재</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul class="sub">
                                    <li><a class=""
                                                   href="/Focus/HL01">기획/연재</a>
                                            </li>
                                        <li><a class=""
                                                   href="/Focus/Interactive">인터랙티브</a>
                                            </li>
                                        <li><a class=""
                                                   href="/Focus/HL02">뉴잼</a>
                                            </li>
                                        </ul>
                            </li>
                        <li>
                                    <div class="anchor-wrap LIFE">
                                    <a href="/Topic" onclick="return false;">주제판</a>
                                    <a class="anchor" href="javascript:;"></a>
                                </div>
                                <ul id="topic-pan-list" class="sub bottom"></ul>
                            </li>
                            <li class="has-line">
                                <a href="/my/subscriptionChannelMain/ALL" class="link">구독<sup class="hk-color">+</sup></a>
                            </li>

                        <li class="">
                            <a class="link" href="/Vertical/Animal">동물</a>
                            </li>
                        <li class="">
                            <a class="link" href="/Vertical/Video">영상</a>
                            </li>
                        </ul>
        </nav>
        <!-- // nav -->
        <!-- bottom-area -->
        <div class="bottom-area">
            <button class="btn-green" onclick="location.href = '/NewsLetter/NewsJam'">뉴스레터 구독</button>
            <ul class="link-list">
                <li><a href="/article/member-report">제보 및 문의</a></li>
                <li><a href="/paoin">지면보기</a></li>
                <li><a href="http://company.hankookilbo.com/Subscription/apply.aspx" target="_blank">구독안내</a></li>
                <li><a href="https://hkphoto.hankookilbo.com" target="_blank">사진검색 & 구매</a></li>
            </ul>
            <ul class="outlink-list">
                <li>
                    <a href="http://yourvibes.co.kr/" target="_blank" class="link-yourvibes">
                        <img src="/images/logo_yourvibe.jpg" alt="your vibes">
                    </a>
                </li>
                <li>
                    <a href="http://www.koreatimes.co.kr/" target="_blank" class="link-koreantimes">
                        <img src="/images/svg/the_korean_times.svg" alt="The Korean Times">
                    </a>
                </li>
            </ul>
        </div>
        <!-- // bottom-area -->

    </div>
    <!-- // container -->
</section>


<div class="subscribe-wrapper imp-mypage-subscribe new-alarm">
    <section class="subscribe new-alarm-sub">
        <div class="subscribe-handle-wrapper " draggable="true">
            <div class="subscribe-handle"></div>
        </div>

        <div class="alarm-header">
            <h3>알림</h3>
            <div class="btn-con">
                <button class="ala-close-btn" onclick="closeNewAlarmList()"></button>
            </div>
        </div>
        <ul class="attension-list new-alarm-list" id="myAlramArea">
        </ul>
        <div class="btn-container">
            <button class="view-more-btn" onclick="location.href='/MyPage?Filter=Alarm'">내 알림 더보기</button>
        </div>
    </section>
</div>


<script>
    var encData;
    $.ajax({
        url: '/auth/cp/data',
        type: 'GET',
        dataType: 'json',
        contentType: 'application/json',
        timeout: 30000,
        success: function (response) {
            $('form input[name="EncodeData"]').val(response.data);
        },
        error: function (req, stat, err) {
            // console.log(err);
        }
    }); // ajax

    function openCpPopup() {
        if (navigator.userAgent.indexOf('Mobile-App') > -1) {
            var data = {
                type: 'SIGN_UP_NICE'
            };
            window.ReactNativeWebView.postMessage(JSON.stringify(data));
            document.form_chk.action = "https://nice.checkplus.co.kr/CheckPlusSafeModel/checkplus.cb";
            document.form_chk.submit();
        } else {
            window.open('', 'popupChk', 'width=500, height=550, top=100, left=100, fullscreen=no, menubar=no, status=no, toolbar=no, titlebar=yes, location=no, scrollbar=no');
            document.form_chk.action = "https://nice.checkplus.co.kr/CheckPlusSafeModel/checkplus.cb";
            document.form_chk.target = "popupChk";
            document.form_chk.submit();
        }
    }

    function cpSuccess(data) {
        encData = data;
        if (authType === 'migration') {
            $.ajax({
                type: "PATCH",
                url: '/users/migration?encData=' + encodeURIComponent(encData),
                success: function (response) {
                    console.log(response);
                    if (response === true) {
                        alert('마이그레이션이 완료되었습니다.');
                        var signInUrl = Cookies.get('sign-in-url');
                        if (signInUrl) {
                            Cookies.remove('sign-in-url');
                            location.replace(signInUrl);
                        } else {
                            location.replace('/');
                        }
                    }
                }
            })
        } else {
            checkExistUserNice();
        }

    }

    function checkExistUserNice() {
        $.ajax({
            type: "GET",
            url: '/users/exist?encData=' + encodeURIComponent(encData),
            cache: false,
            async : false,
            success: function (response) {
                // console.log('본인 인증 회원가입 -> 본인 중복 확인');
                // console.log(JSON.parse(response));
                // console.log(authType);
               // var flag = response;
                var flag = response.flag;
                if (flag) {
                    // 중복이면 이미 가입된 회원
                    // 회원가입일 경우
                    if (authType === 'enroll') {

                        $('.popup-alert').closePopup();
                        $('#sign-up-user-exist-popup').openPopup();
                        niceVeryfiyInfo = null;
                        // 아이디 찾기일 경우
                    } else if (authType === 'idfind') {
                        $.ajax({
                            type: "GET",
                            url: '/api/users/find-id?encData=' + encodeURIComponent(encData),
                            cache: false,
                            async : false,
                            success: function (response) {
                                // console.log(response);
                                var user = response;
                                // 사용자가 있으면
                                if (response !== null) {
                                    location.replace('/users/find-id-result?name=' + user.memName + "&mobile=" + user.memMobile + "&memId=" + user.memId)
                                    // 사용자가 없으면
                                } else {
                                    $('.popup-alert').closePopup();
                                    ('#find-id-no-account-popup').openPopup();
                                }

                            },
                            fail: function (response) {
                                // console.log('아이디 찾기 에러')
                            }
                        })
                    } else if (authType === 'pwfind') {
                        $('#change-password-popup').openPopup();
                    } else if (authType === 'pwchange') {
                        $('#my-page-edit-pw-popup').openPopup();
                    } else if (authType === 'pennamechange') {
                        $('#my-page-edit-pen-name-popup').openPopup();
                    }
                    // 본인인증으로 찾은 아이디가 없을 때
                } else {
                    // 회원가입일 경우
                    if (authType === 'enroll') {

                        //만 14세 미만은 회원가입 불가
                        //debugger;
                        if(parseInt(response.americanAge)<14) {
                            //TODO - signUpType 뭐로 세팅할지 확인 필요
                            //signUpType = '';

                            $('.popup-alert').closePopup();
                            $('#sign-up-nojoin-popup').openPopup();

                        } else {
                            signUpType = 'None';

                            location.href = '/auth/sign-up-nice?encData=' + encodeURIComponent(encData);
                        }
                        // 아이디 찾기일 경우
                    }
                    // 중복 가입이 아니면 약관 동의 화면우
                }
            },
            fail: function (error) {
                // console.log('SNS 회원가입 -> 본인 중복 확인 체크 에러');
                // console.log(JSON.parse(error.responseText));
            }
        });
    }
</script>

<!-- 본인인증 서비스 팝업을 호출하기 위해서는 다음과 같은 form이 필요합니다. -->
<form name="form_chk" method="post">
    <input type="hidden" name="m" value="checkplusSerivce">                        <!-- 필수 데이타로, 누락하시면 안됩니다. -->
    <input type="hidden" name="EncodeData">        <!-- 위에서 업체정보를 암호화 한 데이타입니다. -->
</form>

<section id="sign-up-user-exist-popup" class="popup-alert" style="z-index: 100000">
    <div class="inner">
        <h1 class="title">중복 가입 확인</h1>
        <p>이미 가입된 회원입니다.</p>
        <div class="btn-area">
            <button type="button" onClick="$(this).closest('.popup-alert').closePopup(); location.href = '/auth/sign-in'">확인</button>
        </div>
    </div>
</section>
<section id="sign-up-nojoin-popup" class="popup-alert no-join" style="z-index: 100000">
    <div class="inner">
        <h1 class="title">회원가입 불가</h1>
        <p>만 14세 이상만 회원으로 가입하실 수 있습니다.</p>
        <div class="btn-area">
            <button type="button" onClick="$(this).closest('.no-join').closePopup();">확인</button>
        </div>
    </div>
</section>
<script>
  // 주제판 메뉴
  $.ajax({
    url: "/topic/pan-list",
    method: "GET",
    dataType: "text",
    contentType: "application/json",
    success: function (res) {
      var menuHtml = "";
      JSON.parse(res).forEach(el => {
        /*menuHtml += "<li><a href='/Topic?topicId=" + el.topicId + "'>" + el.topicTitle + "</a></li>"*/;
        menuHtml += "<li><a href='/Topic?topicId=" + el.topicId + "&stt_op=topic_globalgnb_tab_list'>" + el.topicTitle + "</a></li>";
      });
      $("#topic-pan-list").append(menuHtml);
    },
    fail: function (err) {
      $("#topic-pan-list").parent().remove();
    }
  });
</script>

<script>
  var user;

  if (Cookies.get('accessToken') != null) {
    // ui setting
    $('#logOutBtn').removeClass('blind');
    $('#logInBtn').addClass('blind');
    $('#convenient-setting').removeClass('blind');
    $('#event-receive-setting').removeClass('blind');
    $('#account-setting').removeClass('blind');

    $.ajax({
      url: '/users/me',
      type: 'GET',
      contentType: 'application/json',
      success: function (data) {
        // console.log('getuserme -> 성공');
        // console.log(data);
        user = data;
        if (data.sectionCounts !== undefined && data.sectionCounts.length > 0) {
          $('#top-area').html("<p class=\"text\" href=\"#\">\n" +
              "                    안녕하세요.\n" +
              "                    <br><span class=\"point-color\">" + data.memPenName + "</span>님은 최근 <span class=\"point-color\">" +
              data.sectionCounts[0].sectionName + "</span>기사를\n" +
              "                    <br>가장 많이 읽었습니다.\n" +
              "                </p><div class=\"btn-area\"><a href=\"/article/member-report\" class=\"inquiry\">제보 및 문의</a></div>")
        } else {
          $('#top-area').html("<p class=\"text\" href=\"#\">\n" +
              "                    안녕하세요.\n" +
              "                    <span class=\"point-color\">" + data.memPenName + "</span>님</p><div class=\"btn-area\"><a href=\"/article/member-report\" class=\"inquiry\">제보 및 문의</a></div>")
        }

        // 이벤트 및 프로모션 수신 동의 체크
        $('#email-setting-switch').prop('checked', data.eventAgreeEmail === 'Y');
        $('#sms-setting-switch').prop('checked', data.eventSmsAgree === 'Y');
        $('#nLetter-setting-switch').prop('checked', data.nLetterAgree === 'Y');
      },
      error: function (req, stat, err) {
        // console.log(err);
      }
    });
  }

  function onClickSignUp() {
    authType = 'enroll';
    Cookies.set('authType', 'enroll', {path: '/'});
    if (navigator.userAgent.indexOf('Mobile-App') > -1) {
      var data = {
        type: 'SIGN_UP_NICE'
      };
      window.ReactNativeWebView.postMessage(JSON.stringify(data));
    } else {
      openCpPopup();

    }
  }

  function onClickMyPage() {
    if (Cookies.get('accessToken') != null) {
      location.href = '/MyPage';
    } else {
      location.href = '/auth/sign-in';
    }
  }
</script>

<script>
  $(function () {
    var $modal = $(".subscribe-wrapper.imp-mypage-subscribe");
    var $inner = $(".subscribe.new-alarm-sub");
    var $alarmBtn = $(".btn-notice");
    var $body = $("body");

    $alarmBtn.on("click", function () {
      if (Cookies.get('accessToken') != null) {
        $modal.addClass("on");
        $body.css({"overflow": "hidden"});
        $inner.css({"top": 0});

        console.log($inner)
        $inner.draggable({
          handle: '.subscribe-handle-wrapper',
          containment: [0, 0, 0, $(window).height()],
          axis: 'y',
          stop: function (event, ui) {
            if (ui.position.top > 500) {
              $modal.removeClass('on');
              $body.css({"overflow": "auto"});
            } else {
              $inner.css({"top": ui.originalPosition.top});
            }
          },
        });
        alarmToggle();
      } else {
        location.href = '/auth/sign-in';
      }
    })
  })

  function closeNewAlarmList() {
    $(".subscribe-wrapper.imp-mypage-subscribe").removeClass("on");
    $("body").css({overflowY: "auto"});
  }

  function alarmToggle() {
    if (Cookies.get('accessToken') !== undefined) {
      $.ajax({
        url: '/users/push-myalarm-webmobile',
        method: 'GET',
        success: function (response) {
          if (response.code === '0000') {
            var data = response.data;
            var html = '';

            var listSize = data.list.length;
            if (listSize > 0) {
              for (var i = 0; i < listSize; i++) {
                var apppushType = data.list[i].apppushType;
                var typeClass = "";
                var typeNm = "";
                var pushTit = data.list[i].apppushTitle.trim();
                var pushConts = data.list[i].apppushContents;
                var now = moment().format('YYYYMMDD');
                var sendDate = moment(data.list[i].apppushSenddate).format('YYYYMMDD');
                var afterDate = timeForToday(moment(data.list[i].apppushSenddate).format('YYYY-MM-DD hh:mm:ss'));
                var weekend = moment(sendDate).day();
                var weekendNm = '';
                switch (weekend.toString()) {
                  case '0':
                    weekendNm = '일';
                    break;
                  case '1':
                    weekendNm = '월';
                    break;
                  case '2':
                    weekendNm = '화';
                    break;
                  case '3':
                    weekendNm = '수';
                    break;
                  case '4':
                    weekendNm = '목';
                    break;
                  case '5':
                    weekendNm = '금';
                    break;
                  case '6':
                    weekendNm = '토';
                    break;
                }
                var isToday = moment(now).diff(sendDate, 'days') < 1 ? ' (오늘)' : '(' + weekendNm + ')';
                if (i > 0) {
                  var beforeIdx = Number(i - 1);
                  var tempSendDate = moment(data.list[beforeIdx].apppushSenddate).format('YYYYMMDD');
                  if (tempSendDate == moment(data.list[i].apppushSenddate).format('YYYYMMDD')) {
                    sendDate = "";
                    isToday = "";
                  }
                }
                var sendDateFormatIng = '';
                if (Boolean(sendDate)) {
                  sendDateFormatIng = moment(sendDate).format('YYYY. MM. DD');
                }

                html += ' <li class="include-date">';
                html += '     <p class="date-box">' + sendDateFormatIng + ' ' + isToday + '</p>';
                html += '     <a href="/News/Read/' + data.list[i].articleId + '" onclick="fnAlramClick('+"'"+ data.list[i].apppushId +"'"+ ')">';
                var isBadgeUse = false;

                if(Object.keys(PUSH_TYPE).indexOf(apppushType) > -1){
                  typeClass = PUSH_TYPE[apppushType].class;
                  typeNm = PUSH_TYPE[apppushType].name;
                  pushConts = pushConts.replace(new RegExp("\\["+ PUSH_TYPE[apppushType].name +"\\]" , "g"), "");
                  isBadgeUse = true;
                }else{
                  isBadgeUse = false;
                }

                if(isBadgeUse) {
                  html += '     <mark class="' + typeClass + '">' + typeNm + '</mark>';
                }

                if(pushTit !== "한국일보"){
                  if(apppushType === "REPLY_RE" || apppushType === "REACTION"){
                    html += '       <p class="sub-tit">' + pushTit.replace("10", "<strong>10</strong>"); + '</p>';
                  }else if(apppushType === "REPLY" ){
                    html += '       <p class="sub-tit">' + pushTit.replace("답글", "<strong>답글</strong>"); + '</p>';
                  }else{
                    html += '       <p class="sub-tit">' + pushTit + '</p>';
                  }
                }
                html += '         <h5>' + pushConts + '</h5>';
                html += '         <p class="date">' + afterDate + '</p>';
                html += '     </a>';
                html += ' </li>';
              }
            } else {
              html += '    <li class="no-alarm">';
              html += '        <h5>새로운 알림이 없습니다.</h5>';
              html += '    </li>';
            }
            $('#myAlramArea').html(html);
          }
        },
        fail: function (response) {
        }
      });
    }
  }

  function timeForToday(value) {
    var today = new Date();
    var timeValue = new Date(value);

    var betweenTime = Math.floor((today.getTime() - timeValue.getTime()) / 1000 / 60);
    if (betweenTime < 1) return '방금전';
    if (betweenTime < 60) {
      return betweenTime + '분전';
    }

    //메세지 수신 후 12시간이 지나면 년월일시분 노출로 요청 하여 로직 변경
    var betweenTimeHour = Math.floor(betweenTime / 60);

    if (betweenTimeHour < 12) {
        return betweenTimeHour + '시간전';
    } else {
        var timeFormating = moment(timeValue).format('hh시 mm분');
        var isAmPm = moment(timeValue).format('(a)');
        var ampmNm = '';
        switch (isAmPm) {
            case '(am)':
                ampmNm = '오전';
                break;
            case '(pm)':
                ampmNm = '오후';
                break;
        }

        return ampmNm + ' ' + timeFormating;
    }
  }

  function fnAlramClick(arg){
    if (Cookies.get('accessToken') !== undefined && Boolean(arg)) {
      var params = {};
          params = {
              'apppushId': arg
          };
      var url = '/alarm-click';
      $.ajax({
          url: url,
          contentType: 'application/json',
          method: 'PATCH',
          data: JSON.stringify(params),
          async: false,
          success: function (response) {
          },
          fail: function () {
          }
      });
    }
  }
</script>
<section id="searchPopup" class="popup search-popup">
    <div class="header">
        <div class="left">
            <!-- 검색팝업 닫기 -->
            <button type="button" class="btn-back" onclick="$(this).closest('.popup').closePopup();">
                <span class="blind">이전</span>
            </button>
            <!-- .search-input -->
            <div class="search-input">
                <input id="search-input-in-popup" type="text" placeholder="검색어 입력" autocomplete="off">
                <button type="button" class="btn-search" id="btn-search">
                    <span class="blind">검색</span>
                </button>
            </div>
            <!-- // .search-input -->
        </div>
    </div>
    <div class="container">
        <!-- .popular-word-list // 2021-04-08 노출되지않게 처리.-->
<!-- //.popular-word-list -->
        <!-- .recent-word-list -->
        <div class="recent-word-list">
            <div class="title">최근 검색어</div>
            <div id="search-record-empty-list" class="empty-list blind">최근 입력한 검색어가 없습니다.</div>
            <ul id="search-record-list" class="list">
            </ul>
            <!-- <ul class="no-result">
                <li>최근 검색어가 없습니다.</li>
            </ul> -->
        </div>
        <!-- // .recent-word-list -->

        <!-- .auto-complete-list -->
        <div class="auto-complete-list">
            <div class="title">자동 완성</div>
            <ul class="list" id="auto-complete-list">

            </ul>
        </div>
        <!-- // .auto-complete-list -->
    </div>
    <div class="floating-bottom">
        <div class="search-control">
            <button id="search-record-save-off-btn" type="button">검색어 저장 끄기</button>
            <button id="search-record-delete-all-btn" type="button">전체삭제</button>
            </div>
    </div>
</section>

<script>

    var searchPopup;

    function SearchPopup() {
        // constructor() {
        this.searchText = '';
        this.$searchInput = $('#search-input-in-popup');

        this.searchRecord = [];

        // }

        this.init = function () {
            var self = this;
            // 최근검색어 initialize
            this.setSearchRecord();
            // 검색어 저장 On Off 버튼 listener 설정
            this.setSaveSearchRecordOnOffBtnListener();
            // 검색어 전체 삭제 listener 설정
            this.setSearchRecordDeleteAllListener();
            // 검색 버튼 클릭 listener 설정
            this.setSearchBtnListener();
            // 검색 input listener 설정
            this.setSearchInputListener();
            // 인기 검색어 조회
            // 2021-04-08 노출되지않게 처리.
            //this.setPopularKeyword();

            // 검색어 저장 On Off 버튼 initialize
            var searchSaveFlag = Cookies.get('save-search-record-flag');
            if (searchSaveFlag === 'true' || searchSaveFlag === undefined) {
                $('#search-record-save-off-btn').html('검색어 저장 끄기');
            } else {
                $('#search-record-save-off-btn').html('검색어 저장 켜기');
            }

            // 검색어 전체 삭제 initialize
            if (Cookies.get('search-record') !== undefined) {
                $('#search-record-delete-all-btn').attr('disabled', false);
            }
        }

        /**
         * 검색 버튼 클릭
         */
        this.setSearchBtnListener = function () {
            var self = this;
            $('#btn-search').on('click', function () {
                self.searchBySearchText();
            });
        }

        /**
         * 검색어 전체 삭제 listener
         */
        this.setSearchRecordDeleteAllListener = function () {
            var self = this;
            $('#search-record-delete-all-btn').on('click', function () {
                Cookies.remove('search-record');
                self.setSearchRecord();
            })
        };

        /**
         * 검색어 저장 on off 버튼 listener
         */
        this.setSaveSearchRecordOnOffBtnListener = function () {
            var self = this;

            $('#search-record-save-off-btn').on('click', function () {
                var flag = Cookies.get('save-search-record-flag');

                if (flag === 'true' || flag === undefined) {
                    Cookies.set('save-search-record-flag', 'false', {path: '/', expires: 60 * 60 * 24 * 265});
                    $('#search-record-save-off-btn').html('검색어 저장 켜기');
                } else {
                    Cookies.set('save-search-record-flag', 'true', {path: '/', expires: 60 * 60 * 24 * 265});
                    $('#search-record-save-off-btn').html('검색어 저장 끄기');
                }
            })
        }

        /**
         * 최근 검색어 세팅
         */
        this.setSearchRecord = function () {
            $('#search-record-list').html('');
            /**
             * 최근 검색어 쿠키에서 불러오기
             */
            var searchRecordCookie = Cookies.get('search-record');
            // 최근 검색어가 있으면
            if (searchRecordCookie !== undefined) {
                this.searchRecord = searchRecordCookie.split(',');
                // 전체 삭제 버튼 활성화
                $('#search-record-delete-all-btn').attr('disabled', false);
                // 컨테이너 css class toggle
                $('.search-toggle .recent-word').addClass('no-result');

                if (this.searchRecord.length > 0) {
                    // this.searchRecord.reverse();
                    for (var i = 0; i < this.searchRecord.length; i++) {
                        var temp = this.searchRecord[i].split('_splitter');
                        temp[0] = temp[0].replace(/</g,"&lt;").replace(/>/g,"&gt;");
                        var tempOnAtag = temp[0].replace(/\"/g,"\\\"").replace(/\'/g,"\\\'");
                        $('#search-record-list').prepend('<li>\n' +
                            '            <a href="javascript:onClickSearchRecordItem(\'' + tempOnAtag + '\')"><span>' + temp[0] + '</span></a>\n' +
                            '                <span class="date">' + temp[1] + '</span>\n' +
                            '            <button type="button" class="btn-delete" onclick="onClickDeleteSearchRecord(\'' + i + '\', event)"><span class="blind">삭제</span></button>\n' +
                            '                </li>');
                    }
                }

                $('#search-record-empty-list').addClass('blind');
                $('#search-record-list').removeClass('blind');
                // 최근 검색어가 없으면
            } else {
                // 전체 삭제 버튼 비활성화
                $('#search-record-delete-all-btn').attr('disabled', true);
                $('#search-record-empty-list').removeClass('blind');
                $('#search-record-list').addClass('blind');
                // 컨테이너 css class toggle
                $('.search-toggle .recent-word').removeClass('no-result');
            }

        }

        /**
         * 검색어로 검색
         */
        this.searchBySearchText = function () {
            // 동일한 검색어로 검색시 Return
            if (this.searchText === $('#search-input-in-popup').val()) {
                return;
            }

            this.searchText = $('#search-input-in-popup').val();
            this.saveSearchRecord();
            // console.log(this.searchText);
            // location.href = '/Search?searchText=' + encodeURIComponent(this.searchText) + '&tab=NEWS&sort=relation&searchTypeSet=TITLE,CONTENTS&realPaperYN=false&selectedPeriod=slide&sections=SOCIETY,ECONOMY,OPINION,WORLD,ENTER,POLITICS,CULTURE,SPORTS,LOCAL,FOCUS';
            location.href = _searchHost + '/Search?searchText=' + encodeURIComponent(this.searchText);
        };
        /**
         * 최근 검색 기록 추가
         */
        this.saveSearchRecord = function () {
            // 빈 값 검색하면 넣지 않는다
            if ($('#search-input-in-popup').val() === '') {
                return;
            }
            var searchSaveFlag = Cookies.get('save-search-record-flag');

            // 검색어 저장이 true 이면
            if (searchSaveFlag === 'true' || searchSaveFlag === undefined) {
                var now = new Date();
                var ymd = now.getFullYear() + "." + ('0' + (now.getMonth() + 1)).slice(-2) + "." + now.getDate();
                var searchRecord = Cookies.get('search-record');

                // 빈 값이 아니면
                if (searchRecord !== undefined) {
                    var searchRecordList = searchRecord.split(',');

                    if (searchRecordList.length === 10) {
                        searchRecordList.reverse();
                        searchRecordList.pop();
                        searchRecordList.reverse();
                        searchRecord = searchRecordList.join(',');
                    }

                    searchRecord += ',' + $('#search-input-in-popup').val() + "_splitter" + ymd;
                } else {
                    searchRecord = $('#search-input-in-popup').val() + "_splitter" + ymd;
                }

                Cookies.set('search-record', searchRecord, {path: '/', expires: 60 * 60 * 24 * 265});

                this.setSearchRecord();
            }
        }

        /**
         * 검색어 input 리스너 세팅
         */
        this.setSearchInputListener = function () {
            // var self = this;
            // this.$searchInput.on('keyup', function (key) {
            //         //키가 13이면 실행 (엔터는 13)
            //         if (key.keyCode == 13) {
            //             self.searchBySearchText();
            //         }
            //
            //         var param = {
            //             "query": {
            //                 "bool": {
            //                     "should": [{
            //                         "term": {
            //                             "PHRASE_Ngram": Hangul.disassemble(key.target.value).join('')
            //                         }
            //                     }],
            //                     "minimum_should_match": 1
            //                 }
            //             }
            //         };
            //
            //         var relatedSearchKeywordList = '';
            //         $.ajax({
            //             url: "/Search-auto-complete",
            //             method: "POST",
            //             contentType: 'application/json',
            //             data: JSON.stringify(param),
            //             success: function (response) {
            //                 var $autoCompleteList = $('#auto-complete-list');
            //                 $autoCompleteList.html('');
            //
            //                 for (var i = 0; i < response.length; i++) {
            //                     var autocompleteItem = '<li><a id="relatedKeywordItem' + i + '" href="'+_searchHost+'/Search?searchText="> ' + response[i]._id + '</a></li>';
            //                     // autocompleteItem = autocompleteItem.replace(key.target.value, '<span class="point-word">' + key.target.value + '</span>');
            //                     $autoCompleteList.append(autocompleteItem);
            //
            //                     var $autocompleteItem = $('relatedKeywordItem' + i);
            //                     var text = $autocompleteItem.text();
            //                     text = text.replace(key.target.value, '<span class="point-word">' + key.target.value + '</span>');
            //                     $autocompleteItem.html(text);
            //
            //                     $('#relatedKeywordItem' + i).attr('href', _searchHost+'/Search?searchText=' + response[i]._id);
            //                     if (i === 0) {
            //                         relatedSearchKeywordList = response[i]._id;
            //                     } else {
            //                         relatedSearchKeywordList += ',' + response[i]._id;
            //                     }
            //                 }
            //
            //                 Cookies.set('relatedSearchKeyword', relatedSearchKeywordList);
            //
            //             },
            //             fail: function (err) {
            //                 // console.log('댓글 등록 -> 댓글 등록 에러');
            //             }
            //         });
            //     }
            // )
            // ;
        }

        /**
         * 인기 검색어 조회
         */
        this.setPopularKeyword = function () {
            $.ajax({
                url: "/Search-popular-keyword",
                method: "GET",
                success: function (response) {
                    // console.log('인기 검색어 조회 성공');
                    // console.log(response);
                    var popularKeywordList = response;
                    var metaKeywordList = [];

                    if (popularKeywordList.length > 0) {
                        for (var i = 0; i < 20; i++) {
                            var item = popularKeywordList[i];
                            metaKeywordList.push(item.topic);
                            if (i % 4 === 0) {
                                $('#popular-keyword-list').append('<li><a\n' +
                                    '                    href="'+_searchHost+'/Search?searchText=' + encodeURIComponent(item.topic) +'">' + item.topic +'</a>\n' +
                                    '                </li>');
                            }

                            // 인기 검색어는 5개 까지만 넣는다.
                            if (metaKeywordList.length === 5) {
                                break;
                            }

                        }
                        $('meta[name="news_keywords"]').attr('content', metaKeywordList.join(","));
                    }
                },
                fail: function (err) {
                    // console.log('댓글 등록 -> 댓글 등록 에러');
                }
            });
        }
    }


    //////////////////////////////
    ////// html용 함수들 /////////////
    //////////////////////////////

    function onClickDeleteSearchRecord(index, event) {
        // Prevent Submit Form Tag
        event.preventDefault();
        event.stopImmediatePropagation();

        // 해당 인덱스 삭제
        searchPopup.searchRecord.splice(index, 1);

        if (searchPopup.searchRecord.join(',') !== '') {
            Cookies.set('search-record', searchPopup.searchRecord.join(','), {path: '/', expires: 60 * 60 * 24 * 265});
        } else {
            document.cookie = "search-record= ; expires = Thu, 01 Jan 1970 00:00:00 GMT";
        }
        searchPopup.setSearchRecord();
    }

    function onClickSearchRecordItem(searchText) {
        // location.href = '/Search?searchText=' + encodeURIComponent(searchText) + '&tab=NEWS&sort=relation&searchTypeSet=TITLE,CONTENTS&realPaperYN=false&selectedPeriod=slide&sections=SOCIETY,ECONOMY,OPINION,WORLD,ENTER,POLITICS,CULTURE,SPORTS,LOCAL,FOCUS';
        location.href = _searchHost + '/Search?searchText=' + encodeURIComponent(searchText);
    }


    $(document).ready(function () {
        searchPopup = new SearchPopup();
        searchPopup.init();
    })


</script>
<script>
    /*
    // 엔드페이지 진입시 마지막 읽은 기사를 DB에 저장
    var param = {lastReadArticleId: '201512171111528240'};
    $.ajax({
        url: '/users/me',
        method: 'PATCH',
        contentType: 'application/json',
        data: JSON.stringify(param),
        success: function (response) {
            if (response.data) {
                // console.log('이어보기 기사 추가 성공')
            } else {
                // console.log('이어보기 기사 추가 실패')
            }
        }
    });
    */

    if (Cookies.get('prev_article')) {
        $('#top-right-back-btn').addClass('blind');
    } else {
        $('#top-right-back-btn').removeClass('blind');
    }

    function onClickLogo() {
        removeLastReadArticle();
        location.replace('https://m.hankookilbo.com');
    }

    $(document).ready(function() {
        //로그인 하지 않고 기사를 보았을때 쿠키에 하루도안 담고 로그인 하면 읽은 기사에 담기
        // 로그인 flag
        loggedIn = Cookies.get('accessToken');
        if (!loggedIn) {
            if(Cookies.get('view_article') == "undefined" || Cookies.get('view_article') == "" || Cookies.get('view_article') == null){
                Cookies.set('view_article', '201512171111528240', {path: '/', expires: 60 * 60 * 24 * 265});
            }else{
                Cookies.set('view_article', Cookies.get('view_article')+','+'201512171111528240', {path: '/', expires: 1});
            }
        }else{
            /*
            if(Cookies.get('view_article') != "undefined" && Cookies.get('view_article') != null && Cookies.get('view_article') != "") {
                $.ajax({
                    url: "/users/view_article",
                    contentType: 'application/json',
                    method: 'POST',
                    data: JSON.stringify({
                        view_article: Cookies.get('view_article')
                    }),
                    success: function (response) {
                        var flag = response;
                        if (flag) {
                            Cookies.remove('view_article');
                        } else {
                            console.log('기사 구독 -> 실패')
                        }
                    },
                    fail: function () {
                        // console.log('기사 구독 -> 에러')
                    }
                });
            }
            */
        }

        history.pushState(null, null, location.href);
        window.onpopstate = function(event) {
            removeLastReadArticle();
            history.back()
        }
    });

</script>

<!-- // top -->

    <!-- container end -->

    <div class="container imp-end">
        <!-- end-top -->
        <div class="end-top">
            <div class="inn">
    <div class="ttl"><a href="/Collect/709">애니아티클</a></div>
        <h2 class="title">
        개는 진짜로 웃는 걸까</h2>
    <div class="info">
        <dl class="wrt-text">
            <dt>입력</dt>
            <dd>2015.12.17 11:00</dd>
            </dl>
        </div>
    <div class="info">
        <div class="tool-bar">
            <div class="btn-like-all-wrap">
                <button type="button" class="btn-like-all">
                        <span class="blind">좋아요</span>
                        <span id="top-sympathy-cnt" class="count"></span>
                    </button>
                    <div class="like-cont">
                        <span id="top-like-cnt" class="like"><span class="blind">좋아요</span>0</span>
                        <span id="top-dislike-cnt" class="unlike"><span class="blind">싫어요</span>0</span>
                    </div>
                <button type="button" class="btn-comment">
                    <span class="blind">댓글달기</span>
                    <span id="top-comment-cnt" class="count">0</span>
                </button>
            </div>
        </div>
    </div>
</div>
</div>
        <!-- // end-top -->

        <!-- end-body -->
        <div class="end-body">
            <p>반려견이 사람처럼 웃는 표정을 지은 모습은 사랑스럽다. 반려인이라면 반려견도 행복을 느낄 때 웃는다는 사실을 의심하지 않을 것이다. 하지만 개가 웃는다고 생각하는 것은 주인의 착각일 뿐 진짜 웃는 것이 아니란 의견도 있다. </p><figure class="story-media"><div class="photo"><img src="http://newsimg.hankookilbo.com/2015/12/17/201512171111528240_1.jpg" alt=""></div><figcaption class="caption"><span>사람처럼 웃는 반려견의 모습은 사랑스럽다. 사진: 게티이미지뱅크</span></figcaption></figure><p>미국 동물보호단체 ASPCA와 케어링 핸즈 휴메인 소사이어티는 개가 행복한 상태가 되면 개의 안면 근육 긴장이 풀어지면서 개의 입 꼬리가 평소보다 더 올라가고 입을 약간 벌린 상태에서 혀는 아래로 늘어뜨려져 사람처럼 웃는 표정을 짓게 된다고 분석했다. </p><p>개의 미소는 학습과 보상과 연결되어 있을 수 있다. 개는 매우 예리한 관찰자이자 학습능력이 뛰어나다. 따라서 반려견이 이를 드러내며 웃는 표정을 지을 때 주인이 배를 문질러주거나 머리를 쓰다듬고 간식을 주는 등 긍정적인 관심을 준다면 반려견은 보상을 받기 위해 같은 행동을 반복한다. 이런 경우 개는 보상과 웃는 것을 관련 지어 생각하기 때문에 정말 기뻐서 웃는 것이 된다. </p><figure class="story-media"><div class="photo"><img src="http://newsimg.hankookilbo.com/2015/12/17/201512171111528240_2.jpg" alt=""></div><figcaption class="caption"><span>개는 자신의 서열이 더 낮다고 인정할 때 상대 앞에서 웃기도 한다. 사진 : 에픽 스마일링 독 유튜브 캡처</span></figcaption></figure><p>하지만 개의 웃음이 행복이 아니라 복종을 의미한다는 주장도 있다. 동물전문매체 펫플레이스는 개의 조상인 늑대가 서열다툼을 할 때 항복을 나타내는 신호로 미소를 짓는데 이 특성이 개에게 전해졌다고 설명했다. 개가 서열이 높은 상대에게 입 꼬리를 당겨 올리는 표정을 지어 보이면 자신이 서열이 낮다고 인정하는 의미란 얘기다. </p><p>개가 복종의 의미로 입술을 들어올리며 이빨과 잇몸까지 보이는 것과 개가 공격성을 보일 때 이빨을 드러내는 행위와는 다르다. 개들끼리는 그 차이점을 인식할 수 있다고 한다. 반려견이 주인 앞에서 귀를 뒤로 젖히고 머리를 아래로 늘어뜨리는 행동을 하며 웃는 표정을 지으면 복종 행동을 하는 것이다. 하지만 개가 주둥이 코 윗부분에 주름이 갈 정도로 송곳니를 드러낸다면 그것은 상대에게 보내는 경고 신호다. </p><figure class="story-media"><div class="photo"><img src="http://newsimg.hankookilbo.com/2015/12/17/201512171111528240_3.jpg" alt=""></div><figcaption class="caption"><span>유튜브를 통해 유명해진 덴버(리트리버)는 잘못했을 때 실수를 만회하기 위해 주인 앞에서 이를 드러내며 웃는다. 사진: 덴버 아워 길티독 페이스북</span></figcaption></figure><p>한편 개가 웃는 것처럼 보일지라도 심하게 헐떡이거나 이빨을 딱딱 부딪힌다면 스트레스를 받았거나 건강에 문제가 생긴 것일 수 있으니 이런 경우 주의를 기울여야 한다.</p><p>▶ 웃는 개들의 영상 보기 </p><iframe width="640" height="480" src="http://www.youtube.com/embed/WdYSTAznXSs" frameborder="0" allowfullscreen></iframe><p>한송아 인턴기자 <a href="mailto:ssongr2@gmail.com" target="_blank">ssongr2@gmail.com</a> </p><div class="ad-banner">
    <script>
        var is_ins = false;
        
                var adArray = ['endpage@divideshort01', 'endpage@divideshort02', 'endpage@divideshort03'];
            

        // 중복 처리
        var $divideList = $('.ad-banner');
        if ($divideList.length) {
            for (var i = 0; i < $divideList.length; i++) {
                var id = $($divideList[i]).find('.img-box').attr('data-id');
                var adIndex = adArray.indexOf(id);
                if (adIndex > -1) {
                    adArray.splice(adIndex, 1);
                }
            }
        }

        
            var adIndex = 0;
            document.write('<div class="img-box" data-id="' + adArray[adIndex] + '">');
            document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/' + adArray[adIndex] + '"><\/script>');
            document.write('</div>');
        

        // 안드로이드 업데이트용
        if (location.href.indexOf('/News/Read') > -1 && navigator.userAgent.indexOf('Update') > -1) {
            $('.end-ad-container').addClass('blind');
        }
    </script>
</div>
<div class="btn-area reaction-btn-area">
  <button class="btn-like btn-lottie-any" title="공감" data-target-animation="lottie-heart">
      <span class="btn-lottie-any__ico-wrap">
        <i class="btn-lottie-any__ico hidden" id="lottie-heart" data-animation-id="lottie-heart"></i>
      </span>
      <span id="bottom-like-cnt" class="count">0</span>
    </button>
    <button class="btn-unlike btn-lottie-any" title="비공감" data-target-animation="lottie-brokenheart">
      <span class="btn-lottie-any__ico-wrap">
        <i class="btn-lottie-any__ico hidden" data-animation-id="lottie-brokenheart"></i>
      </span>
      <span id="bottom-dislike-cnt" class="count">0</span>
    </button>
  <button class="btn-share">
    <span class="text">공유</span>
  </button>
  <button class="btn-save btn-lottie-any" title="기사저장" data-target-animation="lottie-bookmark" onclick="onClickSaveArticleBtn()">
    <span class="btn-lottie-any__ico-wrap">
      <i class="btn-lottie-any__ico hidden" data-animation-id="lottie-bookmark"></i>
    </span>
    <span class="text">저장</span>
  </button>
  <button class="btn-goto-comment">
    <span class="text">댓글</span>
  </button>
</div>

<script>
  // 제보를 기다립니다 로티 이미지 추가
  $(function() {
    var animItem = bodymovin.loadAnimation({
      container: document.getElementById('report-lottieMessage'),
      renderer: "svg",
      loop: true,
      autoplay: true,
      path: '../../js/lottieJson/lottie-messageArrived.json'
    });
  })

  const lottieBtn = document.querySelectorAll(".reaction-btn-area .btn-lottie-any");
  const lottieAnymations = {};
  function toggleAnimation(classname) {
    const targetAnimation = document.querySelector(classname).dataset.targetAnimation;
    const animationContainer = document.querySelector('[data-animation-id="' + targetAnimation + '"]');
    animationContainer.classList.toggle("hidden");
    if (!lottieAnymations[targetAnimation]) {
      lottieAnymations[targetAnimation] = lottie.loadAnimation({
        container: animationContainer,
        renderer: "svg",
        path: "../../js/lottieJson/" + targetAnimation + ".json",
        autoplay: false,
        loop: false,
      });
    }
    const animation = lottieAnymations[targetAnimation];
    if (animationContainer.classList.contains("hidden")) {
      animation.stop();
    } else {
      animation.play();
    }
  }
</script>
</div>
        <!-- // end-body -->

        <div class="end-bottom">
    <div class="hk-banner">
        <script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/m_newbylow@468x90"></script>
    </div>

    <div class="copy-text">
        세상을 보는 균형, 한국일보 <span class="roboto">Copyright © Hankookilbo</span>
    </div>
</div>

<div class="ad-banner">
    <script>
        var is_ins = false;
        
            var adArray = ['mobile_endpag_3@300x250'];
            

        // 중복 처리
        var $divideList = $('.ad-banner');
        if ($divideList.length) {
            for (var i = 0; i < $divideList.length; i++) {
                var id = $($divideList[i]).find('.img-box').attr('data-id');
                var adIndex = adArray.indexOf(id);
                if (adIndex > -1) {
                    adArray.splice(adIndex, 1);
                }
            }
        }

        
            for (var i = 0; i < 1; i++) {
                if(adArray[i] == 'ins' && is_ins){
                    // document.write('<div class="img-box" data-id="22268266355">');
                    // document.write('<ins class="adsbyaiinad" data-aiinad-inv="22268266355"></ins>');
                    // document.write('</div>');
                    document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/endpage@dividelong02"><\/script>');
                }else{
                    document.write('<div class="img-box" data-id="' + adArray[i] + '">');
                    document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/' + adArray[i] + '"><\/script>');
                    document.write('</div>');
                }

            }
        

        // 안드로이드 업데이트용
        if (location.href.indexOf('/News/Read') > -1 && navigator.userAgent.indexOf('Update') > -1) {
            $('.end-ad-container').addClass('blind');
        }
    </script>
</div>
<!-- Begin Dable 기사하단_리스트 / For inquiries, visit http://dable.io -->
<div class="end-ad-container dable">
    <div id="taboola-below-article-thumbnails-1"></div>
    <script>
        window._taboola = window._taboola || [];
        _taboola.push({
            mode: 'organic-thumbnails-a',
            container: 'taboola-below-article-thumbnails-1',
            placement: 'Below Article Thumbnails 1',
            target_type: 'mix'
        });
    </script>
    <div id="taboola-below-article-thumbnails-2"></div>
    <script>
        window._taboola = window._taboola || [];
        _taboola.push({
            mode: 'organic-thumbnails-b',
            container: 'taboola-below-article-thumbnails-2',
            placement: 'Below Article Thumbnails 2',
            target_type: 'mix'
        });
    </script>
</div>

<!-- ad-banner -->
<div class="ad-banner">
    <script>
        var is_ins = false;
        
            var adArray = ['mobile_endpag_1@300x250'];
            

        // 중복 처리
        var $divideList = $('.ad-banner');
        if ($divideList.length) {
            for (var i = 0; i < $divideList.length; i++) {
                var id = $($divideList[i]).find('.img-box').attr('data-id');
                var adIndex = adArray.indexOf(id);
                if (adIndex > -1) {
                    adArray.splice(adIndex, 1);
                }
            }
        }

        
            for (var i = 0; i < 1; i++) {
                if(adArray[i] == 'ins' && is_ins){
                    // document.write('<div class="img-box" data-id="22268266355">');
                    // document.write('<ins class="adsbyaiinad" data-aiinad-inv="22268266355"></ins>');
                    // document.write('</div>');
                    document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/endpage@dividelong02"><\/script>');
                }else{
                    document.write('<div class="img-box" data-id="' + adArray[i] + '">');
                    document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/' + adArray[i] + '"><\/script>');
                    document.write('</div>');
                }

            }
        

        // 안드로이드 업데이트용
        if (location.href.indexOf('/News/Read') > -1 && navigator.userAgent.indexOf('Update') > -1) {
            $('.end-ad-container').addClass('blind');
        }
    </script>
</div>
<!-- .slider-wrap -->
<div class="card-slider more-articles" data-el="sideLiveIssue">
    <h3>당신이 관심 있을만한 이슈</h3>
    <ul class="card-list slick-slider" data-el="sideLiveIssueList"></ul>
</div>

<script>
    (function() {
        function getRecentIssues(pageNum) {
            var url = '/api/section/bottom-liveissues?Page=' + (pageNum || 1);
            // console.log('라이브 이슈 최근 이슈 조회 -> ' + url);
            $.ajax({
                url: url,
                method: 'GET',
                contentType: 'application/json',
                success: function (response) {
                    var pageableResult = response;
                    response.list = response.list || [];
                    pageableResult.list = response.list.length > 3 ? response.list.slice(0, 4) : response.list
                    // 초기화
                    $('ul[data-el="sideLiveIssueList"]').html('');

                    /**
                     * 최근 이슈
                     */
                    for (var i = 0; i < pageableResult.list.length; i++) {
                        var item = pageableResult.list[i];
                        var article = item.articles.length ? item.articles[0] : null;
                        var articleImagePath = article ? getArticleThumbnailFilePath($('#fileServer').val(), article.articleId, article.repAttach) : '/images/Default-Image.png';
                        var appendItem = '';
                        appendItem += '<li class="item">' +
                            '<div class="item-inner">' +
                            '  <div class="img-card-wrapper">' +
                            '    <div class="hash">' +
                            '      <a href="/Liveissue/' + item.liveIssueId + '">' + item.liveIssueName + '</a>' +
                            '    </div>' +
                            '    <div class="related-count">' +
                            '      <a href="/Liveissue/' + item.liveIssueId + '">' +
                            '        관련기사 <span class="cnt-num">' + item.articleCnt + '</span>' +
                            '      </a>' +
                            '    </div>' +
                            '    <a href="/News/Read/' + article.articleId + '">' +
                            '      <div class="img-box">' +
                            '        <img src="' + articleImagePath + '" alt="' + article.articleTitle + '">' +
                            '      </div>' +
                            '      <div class="title">' + article.articleTitle + '</div>' +
                            '      <div class="text ellipsis multiline two">' + article.articleFrontPanContents + '</div>' +
                            '    </a>' +
                            '  </div>' +
                            '</div>' +
                            '</li>';

                        $('ul[data-el="sideLiveIssueList"]').append(appendItem)
                    }
                    // slick refresh
                    if ($('ul[data-el="sideLiveIssueList"]')[0].slick) {
                        $('ul[data-el="sideLiveIssueList"]')[0].slick.refresh();
                    }
                },
                error: function(){
                    $('div[data-el="sideLiveIssue"]').hide();
                }
            })
        }
        //
        function getTopIssues(pageNum) {
            var url = '/api/section/LIVEISSUE/page';
            $.ajax({
                url: url,
                method: 'GET',
                contentType: 'application/json',
                success: function(res){
                    var issuccess = false;
                    var contents = [];
                    if(Array.isArray(res.areas) && res.areas.length > 0){
                        var data = res.areas[0] || {};
                        var area = data.area || {};
                        var subAreas = data.subAreas;
                        if(area.areaType == "AREA_1" && Array.isArray(subAreas)){
                            issuccess = true;
                            contents = (subAreas[0] || {})['contents'] || [];
                        }
                    }

                    if(issuccess===false || contents.length < 1){
                        $('div[data-el="sideLiveIssue"]').hide();
                        return;
                    }

                    var i=0, html = '', obj, article;
                    contents = contents.length > 3 ? contents.slice(0, 3) : contents;
                    for(;i<contents.length;i+=1){
                        item = contents[i];
                        article = item.article;
                        var articleImagePath = article ? getArticleThumbnailFilePath($('#fileServer').val(), article.articleId, article.repAttach) : '/images/Default-Image.png';

                        html += '<li class="item">' +
                            '<div class="item-inner">' +
                            '  <div class="img-card-wrapper">' +
                            '    <div class="hash">' +
                            '      <a href="/Liveissue/' + item.liveIssueId + '">' + item.liveIssueName + '</a>' +
                            '    </div>' +
                            '    <div class="related-count">' +
                            '      <a href="/Liveissue/' + item.liveIssueId + '">' +
                            '        관련기사 <span class="cnt-num">' + item.articleCnt + '</span>' +
                            '      </a>' +
                            '    </div>' +
                            '    <a href="/News/Read/' + article.articleId + '">' +
                            '      <div class="img-box ">' +
                            '        <img src="' + articleImagePath + '" alt="' + article.articleTitle + '">' +
                            '      </div>' +
                            '      <div class="title">' + article.articleTitle + '</div>' +
                            '      <div class="text ellipsis multiline two">' + article.articleFrontPanContents + '</div>' +
                            '    </a>' +
                            '  </div>' +
                            '</div>' +
                            '</li>';
                    }
                    $('ul[data-el="sideLiveIssueList"]').empty().html(html)
                    // slick refresh
                    if ($('ul[data-el="sideLiveIssueList"]')[0].slick) {
                        $('ul[data-el="sideLiveIssueList"]')[0].slick.refresh();
                    }
                },
                error: function(err){
                    $('div[data-el="sideLiveIssue"]').hide();
                }
            })
        }

        //getRecentIssues();
        getTopIssues();
    })();
</script>

<div class="ad-banner">
    <script>
        var is_ins = false;
        
            var adArray = ['mobile_endpag_2@300x250"'];
            

        // 중복 처리
        var $divideList = $('.ad-banner');
        if ($divideList.length) {
            for (var i = 0; i < $divideList.length; i++) {
                var id = $($divideList[i]).find('.img-box').attr('data-id');
                var adIndex = adArray.indexOf(id);
                if (adIndex > -1) {
                    adArray.splice(adIndex, 1);
                }
            }
        }

        
            for (var i = 0; i < 1; i++) {
                if(adArray[i] == 'ins' && is_ins){
                    // document.write('<div class="img-box" data-id="22268266355">');
                    // document.write('<ins class="adsbyaiinad" data-aiinad-inv="22268266355"></ins>');
                    // document.write('</div>');
                    document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/endpage@dividelong02"><\/script>');
                }else{
                    document.write('<div class="img-box" data-id="' + adArray[i] + '">');
                    document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/' + adArray[i] + '"><\/script>');
                    document.write('</div>');
                }

            }
        

        // 안드로이드 업데이트용
        if (location.href.indexOf('/News/Read') > -1 && navigator.userAgent.indexOf('Update') > -1) {
            $('.end-ad-container').addClass('blind');
        }
    </script>
</div>
<!-- comment-area -->
    <div class="comment-area">
        <!-- comment-title -->
        <h3 class="comment-title">댓글 <span class="count">0</span></h3>
        <!-- // comment-title -->

        <!-- comment-edit -->
        <div class="comment-edit">
            <button onclick="onFocusInput()" id="commentInputContainer" type="button" class="btn-open-edit">
                댓글을 입력해 주세요.
                <span class="btn-reg">등록</span>
            </button>
            <div class="textarea-wrap">
                <div class="textarea">
                    <textarea id="commentInput" rows="2" maxlength="250" placeholder="댓글을 입력해 주세요."></textarea>
                </div>
                <div class="textarea-bottom">
                    <span class="count"><strong>0</strong> / 250</span>
                    <button class="btn-reg" id="submitCommentButton" onclick="onClickSubmitComment()" disabled>등록</button>
                </div>
            </div>
        </div>
        <!-- // comment-edit -->

        <!-- comment-sort-tab -->
        <div class="comment-sort-tab">
            <a id="sortLike" href="javascript:onClickSort('like', this)" class="anchor on">좋아요순</a>
            <a id="sortRecent" href="javascript:onClickSort('recent', this)" class="anchor">최신순</a>

            <a href="javascript:onClickRefresh()" class="refresh">새로고침</a>
        </div>
        <!-- // comment-sort-tab -->

        <!-- .comment-list -->
        <div class="comment-list">
            <ul id="comment-parent-container">
            </ul>
        </div>
        <!-- // .comment-list -->
        <!-- comment-empty -->
        <div class="comment-empty blind">
            첫번째 댓글을 남겨주세요.
        </div>
        <!-- comment-empty -->
        <!-- .btn-all -->
        <button id="show-more-btn" class="btn-all" onclick="getComments(selectedSort, commentData.pageNum + 1, true)">더보기</button>
        <!-- // .btn-all -->
    </div>
    <!-- // comment-area -->

    <!-- .ad-banner -->
    <!-- // .ad-banner -->

    <section id="comment-report-popup" class="popup-alert">
        <div class="inner">
            <h1 class="title">댓글 신고</h1>
            <button class="btn-close" onClick="$(this).closest('.popup-alert').closePopup();">
                <span class="blind">닫기</span>
            </button>
            <p class="mt20">신고 사유를 선택해주세요.</p>
            <div class="radio-group">
                <input class="radio" value="Discomfort" type="radio" name="report-radio" id="rdo_report_01" checked>
                <label for="rdo_report_01">불쾌감 조성(비방/욕설/인신공격)</label>
                <input class="radio" value="IllegalAD" type="radio" name="report-radio" id="rdo_report_02">
                <label for="rdo_report_02">불법 광고 또는 스팸</label>
                <input class="radio" value="ObscenePost" type="radio" name="report-radio" id="rdo_report_03">
                <label for="rdo_report_03">음란성 게시글</label>
                <input class="radio" value="PersonalInfringement" type="radio" name="report-radio" id="rdo_report_04">
                <label for="rdo_report_04">사생활 침해 또는 명예훼손</label>
            </div>
            <div class="btn-area">
                <button type="button" class="is-gray" onClick="$(this).closest('.popup-alert').closePopup();">취소
                </button>
                <button type="button" onClick="onClickSubmitCommentReport()">확인</button>
            </div>
        </div>
    </section>
    <!-- 댓글 삭제 팝업 -->
    <section id="comment-delete-popup" class="popup-alert">
        <div class="inner">
            <h1 class="title">삭제 확인</h1>
            <p>작성하신 글을<br>삭제하시겠습니까?</p>
            <div class="btn-area">
                <button type="button" class="is-gray" onClick="$(this).closest('.popup-alert').closePopup();">취소
                </button>
                <button type="button" onClick="$(this).closest('.popup-alert').closePopup(); deleteComment()">확인
                </button>
            </div>
        </div>
    </section>
    <!-- 댓글 삭제 팝업 -->

    <section id="sign-in-request-popup" class="popup-alert">
        <div class="inner">
            <h1 class="title">로그인 요청</h1>
            <p>로그인 한 후 이용 가능합니다. <br>로그인 하시겠습니까?</p>
            <div class="btn-area">
                <button type="button" class="is-gray" onClick="$(this).closest('.popup-alert').closePopup();">아니오
                </button>
                <button type="button" onClick="Cookies.set('sign-in-url', location.href, { path: '/' }); location.href='/auth/sign-in'">네</button>
            </div>
        </div>
    </section>
    <div id="comment-dimmed" class="dimmed">

    </div>
    <script>
    //2023.07.20. 권세영 수정 - 댓글 안나오는 오류 수정
    var selectedComment, isInit = false;
    var selectedSort = 'likeCnt,desc';
    var commentData = {
        total: 0,
        list: [],
        pageNum: 0,
        pageSize: 0,
        size: 0,
        startRow: 0,
        endRow: 0,
        pages: 0,
        prePage: 0,
        nextPage: 0,
        isFirstPage: false,
        isLastPage: false,
        hasPreviousPage: false,
        hasNextPage: false,
        navigatePages: 0,
        navigatepageNums: [],
        navigateFirstPage: 0,
        navigateLastPage: 0,
    };

    // 신고용
    var selectedOpinionIdForReport;
    // 삭제용
    var selectedOpinionIdForDelete;
    // 답글 등록시 새로 getComments하면 닫히는 것을 막기 위해서
    var selectedOpinionIdForFetch;

    var sch = location.search;
    var params = new URLSearchParams(sch);
    var commentId = params.get('commentId');
    var commentPage = params.get('commentPage');
    var replyId = params.get('replyId');

    $(function(){
        if (commentId != null && commentPage != null) {
            getComments('likeCnt,desc', '1');

            for (i = 2; i <= commentPage; i++) {
                getComments('likeCnt,desc', i, true)
            }
        } else {
            // 페이지가 켜지면 댓글들을 받아온다
            getComments('likeCnt,desc', '0');
        }
    });

    /**
     * 좋아요 버튼
     */
    function onClickLike(id) {
        addCommentSympathy(id, 'Like');
    }

    /**
     * 싫어하기 버튼
     */
    function onClickDislike(id) {
        addCommentSympathy(id, 'Dislike');
    }

    /**
     * 신고하기 팝업 띄우기
     */
    function onClickReport(id) {
        if (Cookies.get('accessToken') === undefined) {
            $('#sign-in-request-popup').addClass('on');
            $('#comment-dimmed').addClass('on');
            return;
        }
        // // console.log(id);
        selectedOpinionIdForReport = id;
        $('#comment-report-popup').addClass('on');
        $('#comment-dimmed').addClass('on');
    }

    /**
     * 신고하기
     */
    function onClickSubmitCommentReport() {
        var selectedReportType = $("input[name='report-radio']:checked").val();
        // // console.log(selectedReportType);
        if (selectedOpinionIdForReport !== undefined) {
            addReport(selectedOpinionIdForReport, selectedReportType);
        }
    }

    /**
     * 댓글 삭제 팝업 띄우는 함수
     */
    function onClickDeleteComment(id) {
        selectedOpinionIdForDelete = id;
        $('#comment-delete-popup').addClass('on');
        $('#comment-dimmed').addClass('on');
    }

    /**
     * 댓글 삭제 함수
     */
    function deleteComment() {
        //return false;
        if (selectedOpinionIdForDelete === undefined) {
            return;
        }
        var url = '/article/' + '201512171111528240' + '/comment/' + selectedOpinionIdForDelete;
        // // console.log(url);
        $.ajax({
            url: url,
            method: 'DELETE',
            success: function (response) {
                // // console.log('기사 댓글 삭제 -> 성공');
                // // console.log(response);
                var flag = response;
                if (flag) {
                    alert("댓글이 삭제되었습니다.");
                    $('#comment-delete-popup').closePopup();
                    $('#comment-parent-container').empty();
                    getComments(selectedSort, commentData.pageNum);
                    selectedOpinionIdForDelete = undefined;
                } else {
                    alert("댓글 삭제 에러");
                    $('#comment-delete-popup').closePopup();
                    selectedOpinionIdForDelete = undefined;
                }
            },
            fail: function (err) {
                // console.log('기사 댓글 삭제 -> 에러');
            }
        });
    }

    /**
     * 공감 추가 함수
     */
    function addCommentSympathy(id, type) {
        //return false;
        var url = '/comment/' + id + '?opinionSympathyType=' + type + '&articleId=201512171111528240';
        // console.log('공감 추가 -> ' + url);
        $.ajax({
            url: url,
            method: 'POST',
            contentType: 'application/json',
            success: function (response) {
                // console.log('공감 추가 -> 성공');

                // 중복이 아니면 true가 내려온다?

                if (response.code === '0000') {
                    if (type === 'Like') {
                        var button = $('#commentLikeButton' + id).html().toString();
                        button = button.replace('<span class="thumb">좋아요</span>', '').replace('<span class="count">', '').replace('</span>', '');
                        var currentCount = parseInt(button);
                        $('#commentLikeButton' + id).addClass('on');
                        $('#commentLikeButton' + id).html('<span class="thumb">좋아요</span><span class="count">' + (currentCount + 1) + '</span>');
                    } else if (type === 'Dislike') {
                        var button = $('#commentDislikeButton' + id).html().toString();
                        button = button.replace('<span class="thumb">싫어요</span>', '').replace('<span class="count">', '').replace('</span>', '');
                        var currentCount = parseInt(button);
                        $('#commentDislikeButton' + id).html('<span class="thumb">싫어요</span><span class="count">' + (currentCount + 1) + '</span>');
                        $('#commentDislikeButton' + id).addClass('on');
                    }
                } else if (response.code === 'EXIST_SYMPATHY') {
                    deleteCommentSympathy(id, type);
                } else {
                    alert('댓글 공감 에러');
                }

                // console.log(response);
            },
            fail: function (err) {
                // console.log('공감 추가 -> 에러');
            }
        });
    }

    /**
     * 공감 제거 함수
     */
    function deleteCommentSympathy(id, type) {
        //return false;
        var url = '/comment/' + id + '?opinionSympathyType=' + type + '&articleId=201512171111528240';

        // console.log('공감 삭제 -> ' + url);
        $.ajax({
            url: url,
            method: 'DELETE',
            contentType: 'application/json',
            success: function (response) {
                // console.log('공감 삭제 -> 성공');
                // console.log(response);
                if (response.code === '0000') {
                    if (type === 'Like') {
                        var button = $('#commentLikeButton' + id).html().toString();
                        button = button.replace('<span class="thumb">좋아요</span>', '').replace('<span class="count">', '').replace('</span>', '');
                        var currentCount = parseInt(button);
                        $('#commentLikeButton' + id).removeClass('on');
                        $('#commentLikeButton' + id).html('<span class="thumb">좋아요</span><span class="count">' + (currentCount - 1) + '</span>')
                    } else if (type === 'Dislike') {
                        var button = $('#commentDislikeButton' + id).html().toString();
                        button = button.replace('<span class="thumb">싫어요</span>', '').replace('<span class="count">', '').replace('</span>', '');
                        var currentCount = parseInt(button);
                        button.replace('<span class="thumb">싫어요</span>', '')
                        $('#commentDislikeButton' + id).removeClass('on');
                        $('#commentDislikeButton' + id).html('<span class="thumb">싫어요</span><span class="count">' + (currentCount - 1) + '</span>')
                    }
                } else {
                    alert('댓글 공감 에러');
                }

            },
            fail: function (err) {
                // console.log('공감 삭제 -> 에러');
            }
        });
    }

    /**
     * 댓글 등록
     */
    function onClickSubmitComment() {
        //return false;
        $('#submitCommentButton').attr('disabled', true);

        var comment = $('#commentInput').val();
        if (comment.length < 251) {
            $.ajax({
                url: '/article/' + '201512171111528240' + '/comment',
                method: "POST",
                contentType: 'application/json',
                data: JSON.stringify({
                    contents: comment,
                }),
                success: function (response) {
                    setGoogleAnalyticsArticleComment();

                    $('#submitCommentButton').attr('disabled', false);
                    if (checkCondition(response) > 0) return;
                    getComments(selectedSort, commentData.pageNum);

                    $('#commentInput').val('');
                    $('#commentInputContainer').removeClass('on');
                    $('#commentInputCount').html('<strong>0</strong> / 250')
                },
                fail: function (err) {
                    // console.log('댓글 등록 -> 댓글 등록 에러');
                }
            });
        }
    }

    function setGoogleAnalyticsArticleComment() {
        var headline = $('meta[name="headline"]').attr('content');
        var content_category = $('meta[name="content_category"]').attr('content');
        var content_subcategory = $('meta[name="content_subcategory"]').attr('content');
        var article_type = $('meta[name="article_type"]').attr('content');
        var article_length = $('meta[name="article_length"]').attr('content');

        if (Cookies.get('accessToken') !== undefined) {
            window.dataLayer = window.dataLayer || [];

            $.ajax({
                url: '/google-analytics/user-details-decrypt',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    dataLayer.push({
                        'event': 'comment',
                        'user_id': data.user_id,
                        'gender': data.gender,
                        'yob': data.yob,
                        'headline': headline,
                        'content_category': content_category,
                        'content_subcategory': content_subcategory,
                        'article_type': article_type,
                        'article_length': article_length,
                    });
                },
                error: function () {
                }
            });
        }
    }

    /**
     * 답글 등록
     */
    function onClickSubmitCommentReply(id) {
        //return false;
        $('#commentSubmitButton' + id).attr('disabled', true);

        selectedOpinionIdForFetch = id;
        var commentReply = $('#commentReplyInput' + id).val();
        var url = '/article/' + '201512171111528240' + '/comment';

        if (commentReply.length < 251) {
            $.ajax({
                url: url,
                method: "POST",
                contentType: 'application/json',
                data: JSON.stringify({
                    contents: commentReply,
                    opinionParentId: id
                }),
                success: function (response) {
                    $('#commentSubmitButton' + id).attr('disabled', false);
                    if (checkCondition(response) > 0) return;
                    getComments(selectedSort, commentData.pageNum);
                },
                fail: function (err) {
                }
            });
        }
    }

    /**
     * 댓글 포커싱
     */
    function onFocusInput() {
        if (Cookies.get('accessToken') === undefined) {
            $('#sign-in-request-popup').addClass('on');
            $('#comment-dimmed').addClass('on');
            setTimeout(function() {
                $('#commentInputContainer').removeClass('on');
            }, 100);
            return;
        }
    }

    /**
     * 신고하기 함수
     */
    function addReport(id, reportType) {
        //return false;
        var url = '/comment/' + id + '?opinionSympathyType=Report&rptType=' + reportType;
        // console.log('신고하기 등록 -> ' + url);
        $.ajax({
            url: url,
            method: 'POST',
            contentType: 'application/json',
            success: function (response) {
                selectedOpinionIdForReport = undefined;

                $('.popup-alert').closePopup();

                if (response.code === '0000') {
                    alert("신고가 접수되었습니다.");
                    // 이미 공감이 있으면 삭제 없으면 추가
                } else if (response.code === 'EXIST_SYMPATHY') {
                    alert('이미 신고한 댓글입니다.');
                } else {
                    alert('댓글 신고 에러');
                }

            },
            fail: function (err) {
                alert("신고하기 에러 발생");
                // console.log('신고하기 등록 -> 에러');
                selectedOpinionIdForReport = undefined;
            }
        });
    }

    /**
     * 답글 포커싱
     */
    function onFocusCommentInput(id) {
        if (Cookies.get('accessToken') === undefined) {
            $('#sign-in-request-popup').addClass('on');
            $('#comment-dimmed').addClass('on');
            return;
        }
        $('#commentReplyInput' + id).on('keyup', function (input) {
            if (input.target.value.length > 0) {
                $('#commentSubmitButton' + id).prop("disabled", false)
            } else {
                $('#commentSubmitButton' + id).prop("disabled", true)
            }
            $('#commentReplyInputCount' + id).html('<strong>' + input.target.value.length + '</strong> / 250');
        })
    }

    /**
     * 답글 input 클릭시
     */
    function onClickCommentReplyInput(id) {
        if (Cookies.get('accessToken') === undefined) {
            $('#sign-in-request-popup').addClass('on');
            $('#comment-dimmed').addClass('on');
            return;
        }
        setTimeout(function () {
            $('#commentReplyInput' + id).focus();
        }, 100);

        $('#commentReplyInputContainer' + id).addClass('on');
    }

    /**
     * 기사 댓글 조회
     * @param sort
     */
    function getComments(sort, pageNum, more = false) {
        //return false;
        //$('.comment-area').hide();
        //return;
        if(isInit){
            $.ajax({
                url: '/article/operation/more/201512171111528240',
                method: "GET",
                contentType: 'application/json',
                async: false,
                success: function (response) {
                    if (response != undefined && response != null && response != '') {
                        if (response.memberOpinionYn == 'N') {
                            $('.comment-area').hide();
                            return;
                        }
                    }
                }
            });
        }

        var url = '/article/' + '201512171111528240' + '/comment?Page=' + pageNum + '&sort=' + sort;
        $.ajax({
            url: url,
            method: "GET",
            contentType: 'application/json',
            success: function (response) {
                commentData = response;
                // console.log(commentData);
                if (commentData.isLastPage) {
                    $('#show-more-btn').addClass('blind');
                } else {
                    $('#show-more-btn').removeClass('blind');
                }

                /**
                 * 초기화
                 */
                $('#commentCntSpan').html('' + commentData.total + '');

                // 댓글 총 개수 설정
                $('.comment-title').html('댓글 <span class="count">' + commentData.total + '</span>');
                if (!more) {
                    $('.comment-list').html('<ul id="comment-parent-container"></ul>');
                }

                // 상단 댓글 총 개수 설정
                $('#top-comment-cnt').html(commentData.total);

                // if (commentData.total !== 0) {
                if (Boolean(commentData.total)) {
                    begin = (commentData.pageNum / 10) * 10 + 1;
                    if (commentData.pageNum % 10 === 0) {
                        begin -= 10;
                    }
                    end = begin + 9;
                    if (commentData.pages < begin + 9) {
                        end = begin;
                    }

                    // 댓글이 없을 때 보여지는 element 제거
                    $('.comment-empty').addClass('blind');
                    $('.comment-list').removeClass('blind');

                    for (var i = 0; i < commentData.list.length; i++) {
                        // 아이템
                        var item;
                        // 삭제 or 신고 버튼
                        var deleteReportButton;
                        // 전체보기 버튼
                        var showAllButtonFlag = 'blind';
                        // 답글 리스트 blind 클래스
                        var replyListBlindClass = 'blind';

                        item = commentData.list[i];
                        item.contents = item.contents.replace(/\n/g, '<br>');

                        // 전체보기 버튼 유무 설정
                        if (item.children.length >= 10) {
                            showAllButtonFlag = '';
                        }

                        if (item.opinionId === selectedOpinionIdForFetch) {
                            replyListBlindClass = '';
                        }

                        // 본인이 쓴 댓글이면 삭제 버튼, 타인이 쓴 댓글이면 신고 버튼
                        if (item.isOwner) {
                            deleteReportButton = '<a id="reportDeleteButton' + item.opinionId + '" href="javascript:onClickDeleteComment(\'' + item.opinionId + '\')" class="report">삭제</a>'
                        } else {
                            deleteReportButton = '<a id="reportDeleteButton' + item.opinionId + '" href="javascript:onClickReport(\'' + item.opinionId + '\')" class="report">신고</a>'
                        }

                        $('#comment-parent-container').append('<li class="comment-item" id="comment' + item.opinionId + '">\n' +
                            '                            <!-- .comment-box -->\n' +
                            '                            <div class="comment-box">\n' +
                            '                                <div class="info">\n' +
                            '                                    <span class="id">' + item.penName + '</span>\n' +
                            '                                    <span class="date">' + getFormattedDate(item.createdDt, 'yyyy.mm.dd hh:mm') + '</span>\n' +
                            '                                    <span class="bar"></span>\n' +
                            '                                    ' + deleteReportButton +
                            '                                </div>\n' +
                            '                                <div class="text">\n' +
                            '                                ' + item.contents + '\n' +
                            '                                </div>\n' +
                            '                                <div class="tool">\n' +
                            '                                    <button type="button" class="btn-reply" onclick="onClickToggleReply(\'' + item.opinionId + '\')">답글<span class="count">' + item.children.length + '</span></button>\n' +
                            '                                    <div class="btn-box">\n' +
                            '                                        <button class="btn-thumbup" id="commentLikeButton' + item.opinionId + '" onclick="onClickLike(\'' + item.opinionId + '\')"><span class="thumb">좋아요</span><span class="count">' + item.likeCnt + '</span></button>\n' +
                            '                                        <button class="btn-thumbdown" id="commentDislikeButton' + item.opinionId + '" onclick="onClickDislike(\'' + item.opinionId + '\')"><span class="thumb">싫어요</span><span class="count">' + item.dislikeCnt + '</span></button>\n' +
                            '                                    </div>\n' +
                            '                                </div>\n' +
                            '                            </div>\n' +
                            '                            <!-- //.comment-box -->\n' +
                            '                            <!-- .reply-list -->\n' +
                            '                            <div class="reply-list" id="commentReply' + item.opinionId + '">\n' +
                            '                                <!-- .reply-edit -->\n' +
                            '                                <div class="reply-edit" onclick="onClickCommentReplyInput(\'' + item.opinionId + '\')">\n' +
                            '                                    <button type="button" class="btn-open-edit" id="commentReplyInputContainer' + item.opinionId + '">답글을 입력 해주세요.\n' +
                            '                                        <span class="btn-reg">등록</span>\n' +
                            '                                    </button>\n' +
                            '                                    <div class="textarea-wrap">\n' +
                            '                                        <div class="textarea">\n' +
                            '                                            <textarea onfocus="onFocusCommentInput(\'' + item.opinionId + '\')" id="commentReplyInput' + item.opinionId + '" rows="3" maxlength="250" placeholder="댓글을 입력해 주세요."></textarea>\n' +
                            '                                        </div>\n' +
                            '                                        <div class="textarea-bottom">\n' +
                            '                                            <span class="count" id="commentReplyInputCount' + item.opinionId + '"><strong>0</strong> / 250</span>\n' +
                            '                                            <button onclick="onClickSubmitCommentReply(\'' + item.opinionId + '\')" class="btn-reg" id="commentSubmitButton' + item.opinionId + '" type="button" disabled>등록</button>\n' +
                            '                                        </div>\n' +
                            '                                    </div>\n' +
                            '                                </div>\n' +
                            '                                <!-- // .reply-edit -->\n' +
                            '                                <ul id="comment-children-container' + item.opinionId + '">\n' +
                            '                                </ul>\n' +
                            '                                <!-- .btn-all -->\n' +
                            '                               <button id="commentReplyShowAllButton' + item.opinionId + '" class="btn-all ' + showAllButtonFlag + '"\n' +
                            '                               onClick="onClickShowAllReply(\'' + item.opinionId + '\')">전체보기</button>\n' +
                            '                                <!-- // .btn-all -->\n' +
                            '                            </div>\n' +
                            '                            <!-- // .reply-list -->\n' +
                            '                        </li>');

                        // 답글
                        for (var j = 0; j < item.children.length; j++) {
                            var childrenItem = item.children[j];
                            var blindClass = "";
                            var childDeleteReportButton;

                            childrenItem.contents = childrenItem.contents.replace(/\n/g, '<br>');

                            // 본인이 쓴 댓글이면 삭제 버튼, 타인이 쓴 댓글이면 신고 버튼
                            if (childrenItem.isOwner) {
                                childDeleteReportButton = '<a id="reportDeleteButton' + childrenItem.opinionId + '" href="javascript:onClickDeleteComment(\'' + childrenItem.opinionId + '\')" class="report">삭제</a>'
                            } else {
                                childDeleteReportButton = '<a id="reportDeleteButton' + childrenItem.opinionId + '" href="javascript:onClickReport(\'' + childrenItem.opinionId + '\')" class="report">신고</a>'
                            }

                            if (j > 9) {
                                blindClass = "blind";
                            }
                            $('#comment-children-container' + item.opinionId).append('<li class="' + blindClass + '">\n' +
                                '  <div class="comment-box">\n' +
                                '    <div class="info">\n' +
                                '      <span class="id">' + childrenItem.penName + '</span>\n' +
                                '      <span class="date">' + getFormattedDate(childrenItem.createdDt, 'yyyy.mm.dd hh:mm') + '</span>\n' +
                                '      <span class="bar"></span>\n' +
                                '                                    ' + childDeleteReportButton +
                                '    </div>\n' +
                                '    <div class="text">\n' +
                                '      ' + childrenItem.contents + '\n' +
                                '    </div>\n' +
                                '    <div class="tool">\n' +
                                '      <div class="btn-box">\n' +
                                '        <button id="commentLikeButton' + childrenItem.opinionId + '" class="btn-thumbup" onclick="onClickLike(\'' + childrenItem.opinionId + '\')"><span\n' +
                                '            class="thumb">좋아요</span>' + childrenItem.likeCnt + '</button>\n' +
                                '        <button id="commentDislikeButton' + childrenItem.opinionId + '" class="btn-thumbdown" onclick="onClickDislike(\'' + childrenItem.opinionId + '\')"><span\n' +
                                '            class="thumb">싫어요</span>' + childrenItem.dislikeCnt + '</button>\n' +
                                '      </div>\n' +
                                '    </div>\n' +
                                '  </div>\n' +
                                '</li>');
                        }

                        selectedOpinionIdForFetch = undefined;
                    }

                    if (commentPage == pageNum) {
                        if (replyId != null) {
                            $('#commentReply' + commentId).addClass('on');
                        }

                        if (commentId != null) {
                            scrollTo(commentId);
                        }
                    }

                } else {
                    $('.comment-list').addClass('blind');
                    $('.comment-empty').removeClass('blind');
                }

                // console.log('기사 댓글 조회 -> 성공');
                // console.log(response);
            },
            fail: function (err) {
                // console.log('기사 댓글 조회 -> 에러');
            }
        });
    }

    /**
     * 새로고침
     */
    function onClickRefresh() {
        getComments(selectedSort, commentData.pageNum);
    }

    /**
     * 정렬하기 함수
     * @param type
     */
    function onClickSort(type) {
        // 좋아요 순 sort
        if (type === 'like') {
            if (selectedSort === 'likeCnt,desc') {
                return;
            }
            selectedSort = 'likeCnt,desc';
            $('#sortLike').toggleClass('on');
            $('#sortRecent').toggleClass('on');
            getComments(selectedSort, '');
            // 최신 순 sort
        } else {
            if (selectedSort === 'createdDt,desc') {
                return;
            }
            selectedSort = 'createdDt,desc';
            $('#sortLike').toggleClass('on');
            $('#sortRecent').toggleClass('on');
            getComments(selectedSort, '');
        }
    }

    /**
     * 유저이름 마스킹
     * @param userId
     * @returns {string}
     */
    function getMaskedUserId(userId) {
        var maskedUserId = userId.substring(0, userId.length / 2);
        maskedUserId += "****";
        return maskedUserId;
    }

    /**
     * 댓글 전체보기
     * @param id
     */
    function onClickShowAllReply(id) {
        // console.log(id);
        // console.log($('#commentReplyShowAllButton' + id).text());
        if ($('#commentReplyShowAllButton' + id).text() === '전체보기') {
            var children = $('#comment-children-container' + id).children();

            // 전체보기 클릭시 숨어있는 리스트 보여준다.
            for (var i = 0; i < children.length; i++) {
                $(children[i]).removeClass('blind');
            }
            $('#commentReplyShowAllButton' + id).html("전체접기");
            $('#commentReplyShowAllButton' + id).toggleClass("on");
            $('#commentReply' + id).removeClass('blind');

        } else {
            $('#commentReplyShowAllButton' + id).html("전체보기");
            $('#commentReplyShowAllButton' + id).toggleClass("on");
            $('#commentReply' + id).addClass('blind');
            scrollTo(id);
        }
    }

    /**
     * 답글 토글 - 지워야함
     * @param id
     */
    function onClickToggleReply(id) {
    }

    /**
     * 스크롤 함수
     * @param id
     */
    function scrollTo(id) {
        var offset = $('#comment' + id).offset();
        $('html, body').animate({scrollTop: offset.top - 200}, 400);
    }

    function checkCondition(response) {
        var returnVal = 0;

        if (response != undefined && response != null && response != '') {
            if (response.returnVal > 0) {
                if (response.returnVal == 1) {
                    alert('댓글/답글은 60초 내에 한 개만 등록하실 수 있습니다.');
                } else if (response.returnVal == 2) {
                    alert('이미 동일 내용의 댓글을 작성하였습니다.');
                } else if (response.returnVal == 3) {
                    alert('댓글에 부적절한 표현이 포함되어 있네요.  건전한 댓글 문화를 위해 등록이 제한됩니다.');
                } else if (response.returnVal >= 4) {
                    var abuserType = '댓글 쓰기 금지';
                    var abuserPeriod = response.UPDATED_DT.substr(0, 10) + ' ~ ' + response.PERIOD_DT.substr(0, 10);

                    if (response.returnVal == 5) abuserType = '기사당 한 개의 댓글만 가능';
                    else if (response.returnVal == 6) abuserType = '댓글 등록은 하루 한개만 가능';
                    if (response.ABUSER_PERIOD == '5') abuserPeriod = '영구금지';

                    alert(
                        '회원 게시물 관리(제 11조 3항)에 의거하여 댓글을 등록할 수 없습니다. \n' +
                        '제재 내용: ' + abuserType + '\n' +
                        '제재 기간: ' + abuserPeriod
                    );
                }
                returnVal = response.returnVal;
            }
        }

        return returnVal;
    }
</script>

<script src='https://kitweb.tadapi.info/network/adapi.h5.js.php?sub=hankook&a=hankook_m_lb_fl_340x250&refercheck=101'></script>

<!-- Begin Dable 하C_세로4_EMPTY_카테베_02 / For inquiries, visit http://dable.io -->
<div data-el="dable3" class="end-ad-container">
    <div id="taboola-below-article-thumbnails-3"></div>
    <script>
        window._taboola = window._taboola || [];
        _taboola.push({
            mode: 'organic-thumbnails-c',
            container: 'taboola-below-article-thumbnails-3',
            placement: 'Below Article Thumbnails 3',
            target_type: 'mix'
        });
    </script>
</div>

<div class="ad-banner">
    <script>
        var is_ins = false;
        
                is_ins = true;
                var adArray = ['endpage@dividelong01', 'ins'];
            

        // 중복 처리
        var $divideList = $('.ad-banner');
        if ($divideList.length) {
            for (var i = 0; i < $divideList.length; i++) {
                var id = $($divideList[i]).find('.img-box').attr('data-id');
                var adIndex = adArray.indexOf(id);
                if (adIndex > -1) {
                    adArray.splice(adIndex, 1);
                }
            }
        }

        
            for (var i = 0; i < 2; i++) {
                if(adArray[i] == 'ins' && is_ins){
                    // document.write('<div class="img-box" data-id="22268266355">');
                    // document.write('<ins class="adsbyaiinad" data-aiinad-inv="22268266355"></ins>');
                    // document.write('</div>');
                    document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/endpage@dividelong02"><\/script>');
                }else{
                    document.write('<div class="img-box" data-id="' + adArray[i] + '">');
                    document.write('<script language="javascript" src="//ad.hankookilbo.com/js/midas/hankookilbo/' + adArray[i] + '"><\/script>');
                    document.write('</div>');
                }

            }
        

        // 안드로이드 업데이트용
        if (location.href.indexOf('/News/Read') > -1 && navigator.userAgent.indexOf('Update') > -1) {
            $('.end-ad-container').addClass('blind');
        }
    </script>
</div>
<div class="ad-banner-end">
    <iframe src="//kitweb.tadapi.info/network/adapi.php?a=hankookilbo_m_at_b_a02_320x50&refercheck=101" framespacing="0" frameborder="no" scrolling="no" topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" width="320" height="50" name="hankookilbo_m_at_b_a02_320x50"></iframe>
</div>
<!-- main -->
<!-- main -->
    </div>
    <!-- // container end -->

</div>
<!-- // wrap -->


<!-- 중복 선택 불가 안내 팝업 -->
<section id="article-sympathy-exist-popup" class="popup-alert already-check">
    <div class="inner">
        <h1 class="title">중복 선택 불가 안내</h1>
        <p>
            이미 공감 표현을 선택하신<br>
            기사입니다. 변경을 원하시면 취소<br>
            후 다시 선택해주세요.
        </p>
        <div class="btn-area">
            <button type="button" onclick="$(this).closest('.popup-alert').closePopup();">확인</button>
        </div>
    </div>
</section>
<!-- // 중복 선택 불가 안내 팝업 -->

<!-- 구독 취소 선택 팝업 -->
<section id="delete-subscription-popup" class="popup-alert">
    <div class="inner">
        <h1 class="title">구독 취소</h1>
        <p>구독을 취소하시겠습니까?</p>
        <div class="btn-area">
            <button type="button" class="gray" onclick="$(this).closest('.popup-alert').closePopup();">아니오</button>
            <button type="button" onclick="$(this).closest('.popup-alert').closePopup(); subscribeTypeCheck();">네</button>
        </div>
    </div>
</section>
<!-- // 구독 취소 선택 팝업 -->

<!-- 구독 유효성검사 -->
<section id="valid-subscription-popup" class="popup-alert">
    <div class="inner">
        <h1 class="title">알림</h1>
        <p>해당 컨텐츠를 구독/취소 하실수 없습니다.</p>
        <div class="btn-area">
            <button type="button" onclick="$(this).closest('.popup-alert').closePopup();">확인</button>
        </div>
    </div>
</section>
<!-- // 구독 유효성검사 -->

<!-- 공유하기 팝업 -->
<section id="pop-share" class="popup-alert">
    <div class="inner">
        <h1 class="title">공유하기</h1>
        <button class="btn-close" onClick="$(this).closest('.popup-alert').closePopup();">
            <span class="blind">닫기</span>
        </button>
        <div class="share-box">
            <a class="kakaotalk" href="javascript:shareKakaotalk()">
                <span class="text">카카오톡</span>
            </a>
            <a class="facebook"
               href="javascript:onClickShareFB()">
                <span class="text">페이스북</span>
            </a>
            <a class="twitter"
               href="javascript:onClickShareTwitter()">
                <span class="text">트위터</span>
            </a>
            <a class="sms"href="javascript:onClickShareWithSms()">
                <span class="text">SMS</span>
            </a>
            <a class="url" href="javascript:copyCurrentUrlToClipboard()">
                <span class="text">링크복사</span>
            </a>
        </div>
    </div>
</section>
<!-- // 공유하기 팝업 -->

<!-- 구독 추가 토스트 팝업 -->
<section id="subscribe-toast" class="popup-toast">
    구독이 추가 되었습니다.
</section>
<!-- // 구독 추가 토스트 팝업 -->

<!-- 구독 취소 토스트 팝업 -->
<section id="unsubscribe-toast" class="popup-toast">
    구독이 취소 되었습니다.
</section>
<!-- // 구독 취소 토스트 팝업 -->

<!-- 구독 취소 토스트 팝업 -->
<section id="save-article-toast" class="popup-toast">
    기사가 저장 되었습니다.
</section>
<!-- // 구독 취소 토스트 팝업 -->

<!-- 구독 취소 토스트 팝업 -->
<section id="delete-article-toast" class="popup-toast">
    기사 저장이 취소되었습니다.
</section>
<!-- // 구독 취소 토스트 팝업 -->

<!-- 링크 복사 토스트 팝업 -->
<section id="toast-save-link" class="popup-toast">
    링크가 복사되었습니다.
</section>
<!-- // 링크 복사 토스트 팝업 -->
<!-- 메일로 공유하기 팝업 -->
<section id="mail-share-popup" class="popup">
    <!-- header -->
    <div class="header">
        <div class="left">
            <a class="logo" href="javascript:;">
                <span class="blind">한국일보</span>
            </a>
        </div>
        <div class="right">
            <button type="button" class="btn-close" onclick="$(this).closest('.popup').closePopup();">
                <span class="blind">닫기</span>
            </button>
        </div>
    </div>
    <!-- // header -->
    <!-- container sub-section -->
    <div class="container email-share">
        <h2>이메일로 기사 공유하기</h2>
        <article>
            <h3 class="share-tit">보내는 기사</h3>
            <p class="news-tit">“대우, 정치적 판단 오류로”…<br/>
                외환위기 그리고 김우중의 한탄</p>
        </article>
        <article>
            <h3>받으실 분</h3>
            <input id="receiver-input" type="text" class="input-text" name="" placeholder="이메일">
            <p id="receiver-guide-msg" class="notice-gray">여러사람에게 보낼 경우 메일주소는 세미콜론(;)으로 구분해 주세요.<br/>
                (최대 5개)</p>
        </article>
        <article>
            <h3>보내는 분</h3>
            <input id="sender-name-input" type="text" class="input-text" name="" placeholder="이름">
            <p id="sender-name-guide-msg" class="notice-red"></p>
            <input id="sender-email-input" type="text" class="input-text" name="" placeholder="이메일">
            <p id="sender-email-guide-msg" class="notice-red"></p>
            <textarea id="sender-ps-input" class="textarea-text" placeholder="함께 보내는 메세지"></textarea>
        </article>
        <a id="mail-send-btn" href="javascript:submit()" class="btn-full middle disabled"  >메일 전송</a>
    </div>
    <!-- // container sub-section -->
</section>
<section id="mail-share-complete-popup" class="popup-alert">
    <div class="inner">
        <h1 class="title">전송완료</h1>
        <p>기사가 메일로 전송되었습니다.</p>
        <div class="btn-area">
            <button type="button"
                    onClick="$(this).closest('.popup-alert').closePopup(); $('#mail-share-popup').closePopup();">확인
            </button>
        </div>
    </div>
</section>
<script>
    var articleTitle;
    var articleContent;
    var articleUrl;
    var articleSection;
    var receiverList;
    var senderName;
    var senderEmail;
    var senderPs;
    var emailRegex = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    var isValidSenderName = false;
    var isValidSenderEmail = false;
    var isValidReceiver = false;

    var receiverGuideMsg = $('#receiver-guide-msg');

    /**
     * 받으실 분 empty 체크
     */
    $('#receiver-input').on('keyup', function (input) {
        if (input.target.value.length === 0) {
            isValidReceiver = false;
        } else {
            isValidReceiver = true;
        }
        checkValidation();
    });

    /**
     * 보내는 분 이름 validation 체크
     */
    $('#sender-name-input').on('keyup', function (input) {
        senderName = input.target.value;
        if (senderName.length === 0) {
            isValidSenderName = false;
            $('#sender-name-guide-msg').html('보내는 분의 이름을 입력해주세요.');
        } else {
            isValidSenderName = true;
            $('#sender-name-guide-msg').html('');
        }
        checkValidation();
    });

    /**
     * 보내는 분 이메일 validation 체크
     */
    $('#sender-email-input').on('keyup', function (input) {
        senderEmail = input.target.value;
        if (!emailRegex.test(senderEmail)) {
            isValidSenderEmail = false;

            $('#sender-email-guide-msg').html('올바른 이메일 형식이 아닙니다.');
        } else {
            isValidSenderEmail = true;
            $('#sender-email-guide-msg').html('')
        }
        checkValidation();
    });

    /**
     * 메일 전송
     */
    function submit() {
        // 받는 사람 이메일 validation check
        receiverList = $('#receiver-input').val().split(';');
        var filteredReceiverList = [];

        // 빈 값이 아닌것만 골라낸다.
        for (var i = 0; i < receiverList.length; i++) {
            if (receiverList[i] !== '') {
                filteredReceiverList.push(receiverList[i]);
            }
        }

        for (var j = 0; j < filteredReceiverList.length; j++) {
            if (filteredReceiverList[j] !== '' && !emailRegex.test(filteredReceiverList[j])) {
                receiverGuideMsg.removeClass('notice-gray blind').addClass('notice-red');
                receiverGuideMsg.text("올바른 이메일 형식이 아닙니다.");
                return;
            }
        }

        if (filteredReceiverList.length > 5) {
            isValidReceiver = false;
            receiverGuideMsg.removeClass('notice-gray blind').addClass('notice-red');
            receiverGuideMsg.text("이메일은 최대 5명까지 보내실 수 있습니다.");
            return;
        }

        // 보내는 분 이메일 체크
        if (!isValidSenderEmail) {
            return;
        }

        // 보내는 분 이름 체크
        if (!isValidSenderEmail) {
            return;
        }

        // 받는 분 체크
        if (!isValidReceiver) {
            return;
        }

        $.ajax({
            url: '/article/share',
            method: 'POST',
            data: JSON.stringify({
                articleId: $('#articleId').val(),
                receiverList: filteredReceiverList,
                articleTitle: $('#articleTitle').val(),
                articleContent: $('#articleContents').val(),
                articleUrl: window.location.href,
                articleSection: $("#articleSection").val(),
                imagePath: $('#articleImageUrl').val(),
                senderName: senderName,
                senderEmail: senderEmail,
                senderPs: $('#sender-ps-input').val(),
                type: 'Email',
                activityType: 'Share'
            }),
            contentType: 'application/json',
            success: function (response) {
                // console.log('기사 이메일로 공유 성공');
                var flag = response;
                // 기사 공유 성공
                if (flag) {
                    setGoogleAnalyticsArticleShare('이메일');

                    $('#mail-share-complete-popup').openPopup();
                } else {
                    // console.log('기사 공유 실패');
                }
            },
            fail: function () {
                // console.log('기사 이메일로 공유 실패');
            },
            complete: function() {
                $('#receiver-input').val('');
                $('#sender-name-input').val('');
                $('#sender-email-input').val('');
                $('#sender-ps-input').val('');
                isValidReceiver = false;
                isValidSenderName = false;
                isValidSenderEmail = false;
            }
        })

    }

    function checkValidation() {
        if (isValidReceiver && isValidSenderEmail && isValidSenderName) {
            $('#mail-send-btn').removeClass('disabled')
        } else {
            $('#mail-send-btn').addClass('disabled')
        }
    }


</script>
<!-- 메일로 공유하기 팝업 -->
<!-- // end_popup -->

<script src="/js/ui.js"></script>
<script src="/js/split.js"></script>

<script src="/js/hmap/hkAnalTag_hub.min.js"></script>
    <script src="/js/hmap/hkAnalTopic.min.js"></script>
<script>
    // 인풋 자동 완성 기능 때문에 fake input 생성
    function offAutocomplete() {
        var E = $('input[type="text"][autocomplete="off"]');
        for (var i = 0 ; i < E.length ; i++) {
            fakeInput = '<input type="text" style="position:absolute;left:-9999px;top:-9999px;width:1px;height:1px;" tabindex="-1">';
            $(fakeInput).insertAfter(E[i]);
        }
    }

    try {
        var userAgent = window.navigator.userAgent;
        var isChrome = userAgent.indexOf('Chrome');
        var isChromeMobile = userAgent.indexOf('CriOS');
        if (isChrome || isChromeMobile) {
            offAutocomplete();
        }
    } catch (e) {

    }
</script>


<!-- 뷰저블 스크립트 -->
<script type="text/javascript">
    (function(w, d, a){
        w.__beusablerumclient__ = {
            load : function(src){
                var b = d.createElement("script");
                b.src = src; b.async=true; b.type = "text/javascript";
                d.getElementsByTagName("head")[0].appendChild(b);
            }
        };w.__beusablerumclient__.load(a);
    })(window, document, "//rum.beusable.net/script/b201026e102031u720/213119441d");
</script>


<div id="hkpage_success"></div>

<!-- taboola 플러시 코드 -->
<script>
    window._taboola = window._taboola || [];
    _taboola.push({flush: true});
</script>
<script src="/js/split/slickExec.js"></script><!-- 카드 슬라이더 .card-slider -->
<script src="/js/lib/jquery.ui.touch-punch.js?ver=3.0.8"></script>
<script src="/js/split/endPage_improve.js?ver=3.0.8"></script>
<script src="/js/lib/lottie.min.js"></script>

<!-- endPage -->
<input id="articleId" type="hidden" value="201512171111528240"/>
<input id="shoulderType" type="hidden" value=""/>
<input id="shoulderId" type="hidden" value="709"/>
<input id="HerbShoulderId" type="hidden" value=""/>
<input id="articleJpageId" type="hidden" value=""/>
<input id="articleHashTagId" type="hidden" value=""/>
<input id="articleContents" type="hidden" value=""/>
<input id="articleTitle" type="hidden" value="개는 진짜로 웃는 걸까"/>
<input id="articleSection" type="hidden" value="라이프"/>
<input id="articleImageUrl" type="hidden" value="https://newsimg.hankookilbo.com/cms/articlerelease/201512171111528240_1.jpg"/>
<script src="/js/split/slickExec.js"></script>
<script src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
<script async defer crossorigin="anonymous"
        src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v6.0&appId=1241983985912870&autoLogAppEvents=1"></script>
<script>Kakao.init('e62df5186f0758def8f14c53e64d7b9d');       // 사용할 앱의 JavaScript 키를 설정</script>

<script>
    // 좋아요 버튼 애니메이션 프레임
    var targetFrames = [];
    var subscribeLocation = '';


    /**
     * 부고 기사 조의 버튼 리스너
     */
    $('.btn-obituary').on('click', function (event) {
        onClickObituaryBtn(event);
    })

    /**
     * 기사 좋아요 버튼 리스너
     */
    $('.btn-like').on('click', function (event) {
        if ($('.btn-unlike').hasClass('on')) {
            $('#article-sympathy-exist-popup').openPopup();
            return;
        }
        onClickLikeArticleBtn(event);
    });

    /**
     * 싫어요 버튼 클릭 리스너
     */
    $('.btn-unlike').on('click', function (event) {
        if ($('.btn-like').hasClass('on')) {
            $('#article-sympathy-exist-popup').openPopup();
            return;
        }
        onClickDislikeArticleBtn(event);
    });

    init();

    /**
     * 기사 정보 초기화 - 좋아요, 싫어요, 기사 구독, 기사 저장 상태 체크
     */
    function init() {
        /*
        getArticleSaveStatus();
        getArticleSubscriptionStatus();
        getLikeArticleStatus();
        getDislikeArticleStatus();
        */
        var dt = {
            articleId: $('#articleId').val(),
            jpageSubValue: $('#articleJpageId').val(),
            tagSubValue: $('#articleHashTagId').val(),
            // seriesSubValue: $('#shoulderId').val(),
            seriesSubValue: $('#HerbShoulderId').val(),
            articleIds: Cookies.get('view_article') == undefined ? '' : Cookies.get('view_article')
        };
        // console.log('is init.dt === ', dt);
        $.ajax({
            url: '/article/view/init',
            contentType: 'application/json',
            method: 'POST',
            data: JSON.stringify(dt),
            success: function (res) {
                // console.log('res === ', res);
                // 1. 마지막 읽은 기사 저장
                if (res._memUpdate > 0) {
                    // console.log('이어보기 기사 추가 성공')
                } else {
                    // console.log('이어보기 기사 추가 실패')
                }

                // 2. 로그인 전 - 읽은 기사 저장
                if (res._activeInsertCnt > 0 && res._errCnt == 0 ) {
                    Cookies.remove('view_article');
                }

                // 3. 구독 가능 여부(기자)
                if (res._jpageSubRecomCnt == 0) {
                    $('.subsc-btn.jpage').show();
                }

                // 4. 구독 가능 여부(태그)
                if (res._tagSubRecomCnt == 0) {
                    $('.subsc-btn.tag').show();
                }

                // 5. 구독 가능 여부(컨텐츠)
                if (res._seriesSubRecomCnt > 0) {
                    $('.btn-subsc').remove();
                } else {
                    $('.btn-subsc').show();
                }

                // 6. 기자 구독 여부
                if (res._jpageSubCnt > 0) {
                    $('.subsc-btn.jpage').addClass('on');
                } else {
                    $('.subsc-btn.jpage').removeClass('on');
                }

                // 7. 태그 구독 여부
                if (res._tagSubCnt > 0) {
                    $('.subsc-btn.tag').addClass('on');
                } else {
                    $('.subsc-btn.tag').removeClass('on');
                }

                // 8. 컨텐츠 구독 여부
                if (res._seriesSubCnt > 0) {
                    $('.btn-subsc').addClass('on');
                } else {
                    $('.btn-subsc').removeClass('on');
                }

                // 9. 독자 의견 설정 여부 확인(댓글 가능 여부)
                if (res._memberOpinionYn == 'N') {
                    $('.comment-area .inner').hide();
                    $('.comment-area').css({padding: 0});
                }
                isInit = true;

                // 10. 기사 저장 상태 조회
                if (res._saveCnt > 0) {
                    $('.btn-save').addClass('on'); // 기사 하단
                    $('.btn-save .btn-lottie-any__ico').removeClass('hidden');
                    $('.icon-btn-bookmark').addClass('on'); // 기사 탑
                }

                // 11. 기사 좋아요 체크
                if (res._likeCnt > 0) {
                    $('.btn-like').addClass('on');
                    $('.btn-like .btn-lottie-any__ico').removeClass('hidden');
                    $('.btn-obituary').addClass('on');
                }

                // 12. 기사 싫어요 체크
                if (res._disLikeCnt > 0) {
                    $('.btn-unlike').addClass('on')
                    $('.btn-unlike .btn-lottie-any__ico').removeClass('hidden');
                }
            },
            fail: function (response) {
                // console.log('기사 저장 상태 조회 -> 실패;');
                // console.log(response);
            }
        });
        getSympathyCnt();
        addViewCnt();
    }

    /**
     * 기사 공감 개수 조회
     */
    function getSympathyCnt() {
        $.ajax({
            url: '/article/' + '201512171111528240' + '/sympathy-count',
            method: 'GET',
            success: function (response) {
                // console.log('기사 공감 토탈 개수 조회 -> 성공');
                // console.log(response);
                var totalCnt = response.likeCnt + response.dislikeCnt;
                $('#top-sympathy-cnt').html(totalCnt);
                $('#top-like-cnt').html(response.likeCnt);
                $('#top-dislike-cnt').html(response.dislikeCnt);
                $('#bottom-like-cnt').html(response.likeCnt);
                $('#bottom-dislike-cnt').html(response.dislikeCnt);
                $('#bottom-obituary-cnt').html(response.likeCnt);
            },
            fail: function () {
                // console.log('기사 공감 토탈 개수 조회 -> 실패');
            }
        });
    }

    /**
     * 기사 조회 수 카운팅
     */
    function addViewCnt() {
        if (Cookies.get('accessToken') != null) {
            $.ajax({
                url: '/article/' + '201512171111528240' + '/count',
                method: 'POST',
                success: function (response) {
                },
                fail: function () {
                }
            });
        }
    }

    /**
     * 기사 저장 상태 조회
     */
    function getArticleSaveStatus() {
        if (Cookies.get('accessToken') !== undefined) {
            $.ajax({
                url: '/article/activity/exist?articleId=' + '201512171111528240' + '&activityType=Save',
                method: 'GET',
                success: function (response) {
                    var flag = response;
                    // console.log('기사 저장 상태 조회 -> 성공');
                    // console.log(response);
                    if (flag) {
                        $('.btn-save').addClass('on'); // 기사 하단
                        $('.icon-btn-bookmark').addClass('on'); // 기사 탑
                    }
                },
                fail: function (response) {
                    // console.log('기사 저장 상태 조회 -> 실패;');
                    // console.log(response);
                }
            });
        }
    }

    /**
     * 기사 저장 버튼 클릭
     */
    function onClickSaveArticleBtn() {
        // 로그인 확인
        if (Cookies.get('accessToken') === undefined) {
            $('#sign-in-request-popup').addClass('on');
            $('#comment-dimmed').addClass('on');
            return;
        }

        // 기사 저장 api를 쏜다 -> 중복체크는 controller에서 한다.
        $.ajax({
            url: '/article/activity',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({
                articleId: '201512171111528240',
                activityType: 'Save'
            }),
            success: function (response) {
                var flag = response;
                if (flag) {
                    $('.btn-save').toggleClass('on'); // 기사 하단
                    $('.icon-btn-bookmark').toggleClass('on'); // 기사 탑

                    if ($('.btn-save').hasClass('on')) {
                        setGoogleAnalyticsArticleSave();

                        $('#save-article-toast').addClass('on');
                        setTimeout(function () {
                            $('#save-article-toast').removeClass('on');
                        }, 2000)
                    } else {
                        $('#delete-article-toast').addClass('on');
                        setTimeout(function () {
                            $('#delete-article-toast').removeClass('on');
                        }, 2000)
                    }

                    toggleAnimation('.btn-save.btn-lottie-any');
                    // css를 바꾼다
                } else {
                    // console.log('기사 저장 -> 실패')
                }
            },
            fail: function () {
                // console.log('기사 저장 -> 에러')
            },
            complete: function () {
                $('.btn-more').removeClass('on');
            }
        })
    }

    function setGoogleAnalyticsArticleSave() {
        var headline = $('meta[name="headline"]').attr('content');
        var content_category = $('meta[name="content_category"]').attr('content');
        var content_subcategory = $('meta[name="content_subcategory"]').attr('content');
        var article_type = $('meta[name="article_type"]').attr('content');
        var article_length = $('meta[name="article_length"]').attr('content');

        if (Cookies.get('accessToken') !== undefined) {
            window.dataLayer = window.dataLayer || [];

            $.ajax({
                url: '/google-analytics/user-details-decrypt',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    dataLayer.push({
                        'event': 'save',
                        'user_id': data.user_id,
                        'gender': data.gender,
                        'yob': data.yob,
                        'headline': headline,
                        'content_category': content_category,
                        'content_subcategory': content_subcategory,
                        'article_type': article_type,
                        'article_length': article_length,
                    });
                },
                error: function () {
                }
            });
        }
    }

    /**
     * 문자로 공유하기
     */
    function onClickShareWithSms() {
        // console.log(window.location.href);
        if (navigator.userAgent.indexOf('Mobile-App') > -1) {
            var data = {
                type: 'SMS_SHARE',
                url: 'https://m.hankookilbo.com/News/Read/201512171111528240?did=sms',
                title: '개는 진짜로 웃는 걸까',
            };
            window.ReactNativeWebView.postMessage(JSON.stringify(data));
        } else {
            if (navigator.userAgent.match(/iPhone/i) != null) {
                location.href = "sms:&body=" + 'https://m.hankookilbo.com/News/Read/201512171111528240?did=sms';
                // TODO vm 이전으로 인해 공유하기 주석처리 차 후 아래 주석 풀고 사용해야 됨
                // location.href = "sms:&body=" + window.location.href;
            } else {
                location.href = "sms:?body=" + 'https://m.hankookilbo.com/News/Read/201512171111528240?did=sms';
                // TODO vm 이전으로 인해 공유하기 주석처리 차 후 아래 주석 풀고 사용해야 됨
                // location.href = "sms:?body=" + window.location.href;
            }
        }

        saveShareActivity('SMS')
    }

    /**
     * url 복사
     */
    function copyCurrentUrlToClipboard() {
        var dummy = document.createElement('input'),
            text = "https://m.hankookilbo.com" + location.pathname + location.search;
        // TODO vm 이전으로 인해 공유하기 주석처리 차 후 아래 주석 풀고 사용해야 됨
        // text = location.protocol +"//" + (location.host.indexOf('.')>-1? location.host.split('.').slice(1).join('.') : location.host) + location.pathname + location.search;

        setTimeout(
            () => {
                document.body.appendChild(dummy);
                dummy.value = text;
                dummy.select();
                document.execCommand('copy');
                document.body.removeChild(dummy);
                $('#toast-save-link').openPopup();
                $('#pop-share').closePopup();
            }
        );

        saveShareActivity('URL');
    }

    /**
     * 카카오로 공유하기
     */
    function shareKakaotalk() {
        if (navigator.userAgent.indexOf('Mobile-App') > -1) {
            var data = {
                type: 'KAKAO_SHARE',
                url: 'https://m.hankookilbo.com/News/Read/201512171111528240?did=kk',
                title: $('#articleTitle').val(),
                imageUrl: 'https://newsimg.hankookilbo.com/cms/articlerelease/201512171111528240_1.jpg'
            };
            window.ReactNativeWebView.postMessage(JSON.stringify(data));
        } else {
            Kakao.Link.sendDefault({
                objectType: "feed"
                , content: {
                    title: $('#articleTitle').val(),
                    description: $('#articleContents').val(),
                    imageUrl: 'https://newsimg.hankookilbo.com/cms/articlerelease/201512171111528240_1.jpg',   // 썸네일 이미지
                    link: {
                        mobileWebUrl: 'https://m.hankookilbo.com/News/Read/201512171111528240?did=kk',   // 모바일 카카오톡에서 사용하는 웹 링크 URL
                        webUrl: 'https://m.hankookilbo.com/News/Read/201512171111528240?did=kk' // PC버전 카카오톡에서 사용하는 웹 링크 URL
	                    /*mobileWebUrl: "https://m.hankookilbo.com" + '/News/Read/201512171111528240?did=kk',   // 모바일 카카오톡에서 사용하는 웹 링크 URL
                        webUrl: "https://m.hankookilbo.com" + '/News/Read/201512171111528240?did=kk' // PC버전 카카오톡에서 사용하는 웹 링크 URL*/
                    }
                }
            });
        }

        saveShareActivity('카카오톡');
    }

    /**
     * 이메일로 공유하기
     */
    function onClickShareWithEmail() {
        $('#pop-share').closePopup();
        $('#mail-share-popup').openPopup();
        articleTitle = '메일 공유하기 테스트 제목';
        articleContent = '메일 공유하기 내용';
        articleUrl = "https://m.hankookilbo.com" + location.pathname + location.search;
        // TODO vm 이전으로 인해 공유하기 주석처리 차 후 아래 주석 풀고 사용해야 됨
        // articleUrl = location.protocol +"//" + (location.host.indexOf('.')>-1? location.host.split('.').slice(1).join('.') : location.host) + location.pathname + location.search;
        articleSection = '정치';
    }


    /**
     * 페이스북 공유 클릭
     */
    function onClickShareFB() {
        if (navigator.userAgent.indexOf('Mobile-App') > -1) {
            var data = {
                type: 'FACEBOOK_SHARE',
                url: 'https://m.hankookilbo.com/News/Read/201512171111528240?did=fa',
                title: $('#articleTitle').val(),
                imageUrl: 'https://newsimg.hankookilbo.com/cms/articlerelease/201512171111528240_1.jpg'
            };
            window.ReactNativeWebView.postMessage(JSON.stringify(data));
        } else {
            var token;
            FB.login(function (response) {
                // console.log("페이스북 로그인");
                token = response.authResponse.accessToken;

                FB.api('/', 'POST', {
                    "id": 'https://m.hankookilbo.com' + '/News/Read/201512171111528240?did=fa',
                    "scrape": "true",
                    "access_token": token
                }, function (res) {
                    window.open('https://www.facebook.com/sharer/sharer.php?u=https://m.hankookilbo.com/News/Read/201512171111528240?did=fa', 'facebook-share-dialog', 'width=800,height=600');
                });
            });

        }

        saveShareActivity('페이스북');

    }

    /**
     * 트위터 공유 클릭
     */
    function onClickShareTwitter() {
        if (navigator.userAgent.indexOf('Mobile-App') > -1) {
            var data = {
                type: 'TWITTER_SHARE',
                url: 'https://m.hankookilbo.com/News/Read/201512171111528240?did=tw',
                title: '개는 진짜로 웃는 걸까'
            };
            window.ReactNativeWebView.postMessage(JSON.stringify(data));
        } else {
            window.open('https://twitter.com/share?text=개는 진짜로 웃는 걸까&url=https://m.hankookilbo.com/News/Read/201512171111528240?did=tw', 'twitter-popup', 'height=350,width=600');
        }

        saveShareActivity('트위터');
    }

    /**
     * 공유한 기록 저장
     */
    function saveShareActivity(share_type) {
        setGoogleAnalyticsArticleShare(share_type);

        if (Cookies.get('accessToken') != null) {
            $.ajax({
                url: '/article/share',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    type: 'Sns',
                    articleId: '201512171111528240',
                    activityType: 'Share'
                }),
                success: function (response) {
                    // console.log('share save success')
                },
                fail: function () {
                    // console.log('share save fail')
                }
            })
        }
    }

    /**
     * 기사 구독 버튼 클릭
     */
    function onClickSubscribeArticleBtn(location) {
        subscribeLocation = location;

        // 로그인 확인
        if (Cookies.get('accessToken') === undefined) {
            $('#sign-in-request-popup').addClass('on');
            $('#comment-dimmed').addClass('on');
            return;
        }

        if ($(event.target).hasClass('on')) {
            $('#delete-subscription-popup').openPopup();
            return;
        }
        subscribeTypeCheck();
    }

    /**
     * 구독 분기 함수
     */
    function subscribeTypeCheck(){
        if(subscribeLocation == 'JPAGE' || subscribeLocation == 'TAG'){
            subscribeArticleNew(subscribeLocation);
        }else{
            subscribeArticle();
        }
    }

    /**
     * 기사 구독
     */
    function subscribeArticle() {
        // 기사 구독 api를 쏜다 -> 중복체크는 controller에서 한다.
        let usersSubscriptionPart = '';
        let usersSubscriptionValue = '';
        
        let seriesType = '';
        switch (usersSubscriptionPart){
            case 'SeriesColumn':
                seriesType = 'NEWS_SERIES'
                break;
            case 'Planning':
                seriesType = 'NEWS_PLANNING'
                break;
            case 'Series':
                seriesType = 'NEWS_PLANNING'
                break;
            case 'NameColumn':
                seriesType = 'NEWS_SERIES'
                break;
        }
        $.ajax({
            url: '/my/subscription',
            method: "POST",
            contentType: 'application/json',
            data: JSON.stringify({
                usersSubscriptionPart: seriesType,
                usersSubscriptionValue: usersSubscriptionValue
            }),
            success: function (response) {
                var successYn = response;
                if (successYn === 'Y') {
                    // css를 바꾼다
                    // console.log('기사 구독 -> 성공');
                    //GA4 - 시리즈 구독
                    fn_setGoogleAnalyticsUserDetailsJPage("");
                    $('.btn-subsc').toggleClass('on');

                    // if ($('.subsc-btn.jpage').hasClass('on')) {
                    //     $('.subsc-btn.jpage').siblings('.add-pop').show();
                    // } else {
                    //     $('.subsc-btn.jpage').siblings('.cancel-pop').show();
                    // }
                } else if(successYn === 'F') {
                    $('#valid-subscription-popup').openPopup();
                    $('.btn-subsc').remove();
                } else {
                    // console.log('기사 구독 -> 실패')
                }
            }, fail: function (error) {
                //
            }
        });

    }


    /**
     * 기사 구독 상태 조회
     */
    function getArticleSubscriptionStatus() {
        let usersSubscriptionPart = $("#shoulderType").val();
        let usersSubscriptionValue = $("#shoulderId").val();
        if( !getUsersSubscriptionYNCheck(usersSubscriptionPart,usersSubscriptionValue) ){
            $('.btn-subsc').remove();
        }
        else {
            if (Cookies.get('accessToken') !== undefined) {
                let seriesType = '';
                switch (usersSubscriptionPart) {
                    case 'SeriesColumn':
                        seriesType = 'NEWS_SERIES'
                        break;
                    case 'Planning':
                        seriesType = 'NEWS_PLANNING'
                        break;
                    case 'Series':
                        seriesType = 'NEWS_PLANNING'
                        break;
                    case 'NameColumn':
                        seriesType = 'NEWS_SERIES'
                        break;
                }
                var url = '/api/section/users-subscription-check?usersSubscriptionValue=' + usersSubscriptionValue + '&usersSubscriptionPart=' + seriesType;
                $.ajax({
                    url: url,
                    method: 'GET',
                    contentType: 'application/json',
                    success: function (response) {
                        // console.log('기사 구독 상태 조회 -> 성공');
                        // console.log(response);
                        var flag = response;
                        if (flag === 'Y') {
                            $('.top-bar .btn-subsc').addClass('on');
                            $('.end-bottom .btn-subsc').addClass('on');
                        } else {
                            $('.top-bar .btn-subsc').removeClass('on');
                            $('.end-bottom .btn-subsc').removeClass('on');
                        }
                    },
                    fail: function (err) {
                        // console.log('기사 구독 상태 조회 -> 실패');
                    }
                });
            }
        }
    }

    /**
     * 기사 좋아요 상태 조회
     */
    function getLikeArticleStatus() {
        // if (getCookie('accessToken') !== undefined) {
        $.ajax({
            url: '/article/activity/exist?articleId=' + '201512171111528240' + '&activityType=Sympathy&activityValue=Y',
            method: 'GET',
            success: function (response) {
                var flag = response;
                // console.log('기사 좋아요 상태 조회 -> 성공');
                // console.log(response);
                if (flag) {
                    $('.btn-like').addClass('on');
                    $('.btn-obituary').addClass('on');
                } else {
                    // $('.btn-subsc').removeClass('on');
                }
            },
            fail: function (response) {
                // console.log('기사 저장 상태 조회 -> 실패');
                // console.log(response);
            }
        });
        // }
    }

    /**
     * 기사 싫어요 상태 조회
     */
    function getDislikeArticleStatus() {
        // if (getCookie('accessToken') !== undefined) {
        $.ajax({
            url: '/article/activity/exist?articleId=' + '201512171111528240' + '&activityType=Sympathy&activityValue=N',
            method: 'GET',
            success: function (response) {
                var flag = response;
                // console.log('기사 싫어요 상태 조회 -> 성공');
                // console.log(response);
                if (flag) {
                    $('.btn-unlike').addClass('on')
                } else {
                }
            },
            fail: function (response) {
                // console.log('기사 저장 상태 조회 -> 실패');
                // console.log(response);
            }
        });
        // }
    }

    /**
     * 기사 부고 버튼 클릭
     */
    function onClickObituaryBtn(event) {
        event.stopImmediatePropagation();
        // 기사 좋아요 api를 쏜다 -> 중복체크는 controller에서 한다.
        $.ajax({
                url: '/article/activity',
                contentType: 'application/json',
                method: 'POST',
                data: JSON.stringify({
                    articleId: $('#articleId').val(),
                    activityType: 'Sympathy',
                    activityValue: 'Y'
                }),
                success: function (response) {
                    var flag = response;
                    // console.log(flag);
                    if (flag) {
                        // console.log('기사 부고 -> 성공');
                        var totalCount = parseInt($('#sympathyCntSpan').html());
                        endBtnObituary.$btn.toggleClass('on');
                        // css를 바꾼다
                        if (endBtnObituary.$btn.hasClass('on')) {
                            targetFrames = [endBtnObituary.startA, endBtnObituary.endA];
                            endBtnObituary.anim.playSegments([targetFrames], true);
                            var count = parseInt($('#bottom-obituary-cnt').html());
                            // console.log(count);
                            $('#bottom-obituary-cnt').html(count + 1);
                            $('#sympathyCntSpan').html(totalCount + 1);
                        } else {
                            targetFrames = [endBtnObituary.startB, endBtnObituary.endB];
                            endBtnObituary.anim.playSegments([targetFrames], true);
                            var count = parseInt($('#bottom-obituary-cnt').html());
                            $('#bottom-obituary-cnt').html(count - 1);
                            $('#sympathyCntSpan').html(totalCount - 1);
                        }

                    } else {
                        // console.log('기사 부고 -> 실패')
                    }
                },
                fail: function () {
                    // console.log('기사 좋아요 -> 에러')
                }
            }
        )
    }

    /**
     * 기사 좋아요 버튼 클릭
     */
    function onClickLikeArticleBtn(event) {
        event.stopImmediatePropagation();
        // 기사 좋아요 api를 쏜다 -> 중복체크는 controller에서 한다.
        $.ajax({
                url: '/article/activity',
                contentType: 'application/json',
                method: 'POST',
                data: JSON.stringify({
                    articleId: '201512171111528240',
                    activityType: 'Sympathy',
                    activityValue: 'Y'
                }),
                success: function (response) {
                    var flag = response;
                    // console.log(flag);
                    if (flag) {
                        // console.log('기사 좋아요 -> 성공');
                        var totalCount = parseInt($('#top-sympathy-cnt').html());
                        $('.btn-like').toggleClass('on');
                        // css를 바꾼다
                        if ($('.btn-like').hasClass('on')) {
                            setGoogleAnalyticsArticleReaction('좋아요');

                            var count = parseInt($('#bottom-like-cnt').html());
                            $('#top-like-cnt').html(count + 1);
                            $('#bottom-like-cnt').html(count + 1);
                            $('#top-sympathy-cnt').html(totalCount + 1);
                        } else {
                            var count = parseInt($('#bottom-like-cnt').html());
                            $('#top-like-cnt').html(count - 1);
                            $('#bottom-like-cnt').html(count - 1);
                            $('#top-sympathy-cnt').html(totalCount - 1);
                        }

                        toggleAnimation('.btn-like.btn-lottie-any');
                    } else {
                        // console.log('기사 좋아요 -> 실패')
                    }
                },
                fail: function () {
                    // console.log('기사 좋아요 -> 에러')
                }
            }
        )
    }

    /**
     * 기사 싫어요 버튼 클릭
     */
    function onClickDislikeArticleBtn(event) {
        event.stopImmediatePropagation();
        // 기사 싫어요 api를 쏜다 -> 중복체크는 controller에서 한다.
        $.ajax({
            url: '/article/activity',
            contentType: 'application/json',
            method: 'POST',
            data: JSON.stringify({
                articleId: '201512171111528240',
                activityType: 'Sympathy',
                activityValue: 'N'
            }),
            success: function (response) {
                var flag = response;
                // console.log(flag);
                var totalCount = parseInt($('#top-sympathy-cnt').html());
                $('.btn-unlike').toggleClass('on');
                if (flag) {
                    // console.log('기사 싫어요 -> 성공');
                    // css를 바꾼다
                    if ($('.btn-unlike').hasClass('on')) {
                        setGoogleAnalyticsArticleReaction('싫어요');

                        var count = parseInt($('#bottom-dislike-cnt').html());
                        $('#bottom-dislike-cnt').html(count + 1);
                        $('#dislikeCntLi').html(count + 1);
                        $('#top-sympathy-cnt').html(totalCount + 1);
                    } else {
                        var count = parseInt($('#bottom-dislike-cnt').html());
                        $('#bottom-dislike-cnt').html(count - 1);
                        $('#dislikeCntLi').html(count - 1);
                        $('#top-sympathy-cnt').html(totalCount - 1);
                    }

                    toggleAnimation('.btn-unlike.btn-lottie-any');
                } else {
                    // console.log('기사 싫어요 -> 실패')
                }
            },
            fail: function () {
                // console.log('기사 싫어요 -> 에러')
            }
        })
    }

    function setGoogleAnalyticsArticleReaction(reaction_type) {
        var headline = $('meta[name="headline"]').attr('content');
        var content_category = $('meta[name="content_category"]').attr('content');
        var content_subcategory = $('meta[name="content_subcategory"]').attr('content');
        var article_type = $('meta[name="article_type"]').attr('content');
        var article_length = $('meta[name="article_length"]').attr('content');

        if (Cookies.get('accessToken') !== undefined) {
            window.dataLayer = window.dataLayer || [];

            $.ajax({
                url: '/google-analytics/user-details-decrypt',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    dataLayer.push({
                        'event': 'reaction',
                        'user_id': data.user_id,
                        'reaction_type': reaction_type,
                        'gender': data.gender,
                        'yob': data.yob,
                        'headline': headline,
                        'content_category': content_category,
                        'content_subcategory': content_subcategory,
                        'article_type': article_type,
                        'article_length': article_length,
                    });
                },
                error: function () {
                }
            });
        }
    }

    /**
     * 기자 구독
     */
    function subscribeArticleNew(location) {
        // 기사 구독 api를 쏜다 -> 중복체크는 controller에서 한다.
        if (location == 'JPAGE') {
            $.ajax({
                url: '/my/subscription',
                method: "POST",
                contentType: 'application/json',
                data: JSON.stringify({
                    usersSubscriptionPart: location,
                    usersSubscriptionValue: ''
                }),
                success: function (response) {
                    var successYn = response;
                    if (successYn === 'Y') {
                        //GA4 - 기자 구독
                        fn_setGoogleAnalyticsUserDetailsJPage("");
                        // css를 바꾼다
                        // console.log('기사 구독 -> 성공');
                        $('.subsc-btn.jpage').toggleClass('on');

                        // if ($('.subsc-btn.jpage').hasClass('on')) {
                        //     $('.subsc-btn.jpage').siblings('.add-pop').show();
                        // } else {
                        //     $('.subsc-btn.jpage').siblings('.cancel-pop').show();
                        // }
                    } else if(successYn === 'F') {
                        $('#valid-subscription-popup').openPopup();
                        $('.subsc-btn.jpage').remove();
                    } else {
                        // console.log('기사 구독 -> 실패')
                    }
                }, fail: function (error) {
                    //
                }
            });
        } else if (location == 'TAG') { //모바일에서 태그는 현재 보이지 않음.
            $.ajax({
                url: '/my/subscription',
                method: "POST",
                contentType: 'application/json',
                data: JSON.stringify({
                    usersSubscriptionPart: location,
                    usersSubscriptionValue: ''
                }),
                success: function (response) {
                    var successYn = response;
                    if (successYn) {
                        // css를 바꾼다
                        // console.log('기사 구독 -> 성공');
                        $('.top-bar .btn-subsc').toggleClass('on');
                        $('.end-bottom .btn-subsc').toggleClass('on');

                        // if ($('.subsc-btn.tag').hasClass('on')) {
                        //     $('.subsc-btn.tag').siblings('.add-pop').show();
                        // } else {
                        //     $('.subsc-btn.tag').siblings('.cancel-pop').show();
                        // }
                    } else {
                        // console.log('기사 구독 -> 실패')
                    }
                },
                fail: function (error) {
                    //
                }
            });
        }
    }

    /**
     * 이전 기사 설정
     */
    if (Cookies.get('curr_article')) {
        Cookies.set('prev_article', Cookies.get('curr_article'), {path: '/'});
    }
    Cookies.set('curr_article', '201512171111528240', {path: '/'});

    if (Cookies.get('prev_article') !== undefined && Cookies.get('prev_article') !== Cookies.get('curr_article')) {
        $('#top-right-back-btn').removeClass('blind');
        $('#top-right-back-btn').attr("href", "/News/Read/" + Cookies.get('prev_article'));
    } else {
        $('#top-right-back-btn').addClass('blind');
    }

    /**
     * 관심 있을 만한 뉴스
     */
    Cookies.set('read_article', $('#articleId').val(), {path: '/'});

    /**
     * 닫기 버튼 눌렀을 때
     */
    $('#top-right-close-btn').on('click', function () {
        removeLastReadArticle();
        Cookies.remove('prev_article');
        Cookies.remove('curr_article');
        // console.log(Cookies.get('closeUrl'));
        if (Cookies.get('closeUrl') === undefined) {
            location.replace('/');
        } else {
            location.replace(Cookies.get('closeUrl'))
        }
    });

    /**
     * 기자 구독상태 조회
     */
    function getUsersSubscriptionCheckJpageId(type, id) {
        if( !getUsersSubscriptionYNCheck(type,id) ){
            if(type == 'JPAGE'){
                $('.subsc-btn.jpage').remove();
            }else if(type == 'TAG'){
                $('.subsc-btn.tag').remove();
            }
        }
        else {
            var url = '/api/section/users-subscription-check?usersSubscriptionValue=' + id + '&usersSubscriptionPart=' + type;
            $.ajax({
                url: url,
                method: 'GET',
                contentType: 'application/json',
                success: function (response) {
                    //console.log('기사 구독 상태 조회 -> 성공');
                    //console.log(response);
                    var successYn = response;
                    if (successYn == "Y") {
                        if (type == 'JPAGE') {
                            $('.subsc-btn.jpage').addClass('on')
                        } else if (type == 'TAG') {
                            $('.end-bottom .btn-subsc').addClass('on')
                        }
                    } else if (successYn == "N") {
                        if (type == 'JPAGE') {
                            $('.subsc-btn.jpage').removeClass('on')
                        } else if (type == 'TAG') {
                            $('.end-bottom .btn-subsc').removeClass('on')
                        }
                    }
                },
                fail: function (err) {
                    console.log('기자 구독 조회-> 에러');
                    $('div[data-el="sideHashNews"]').hide();
                }
            });
        }
    }

    //getUsersSubscriptionCheckJpageId("JPAGE", "");

    function setGoogleAnalyticsArticleShare(share_type) {
        var headline = $('meta[name="headline"]').attr('content');
        var content_category = $('meta[name="content_category"]').attr('content');
        var content_subcategory = $('meta[name="content_subcategory"]').attr('content');
        var article_type = $('meta[name="article_type"]').attr('content');
        var article_length = $('meta[name="article_length"]').attr('content');

        if (Cookies.get('accessToken') !== undefined) {
            window.dataLayer = window.dataLayer || [];

            $.ajax({
                url: '/google-analytics/user-details-decrypt',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    dataLayer.push({
                        'event': 'share',
                        'user_id': data.user_id,
                        'share_type': share_type,
                        'gender': data.gender,
                        'yob': data.yob,
                        'headline': headline,
                        'content_category': content_category,
                        'content_subcategory': content_subcategory,
                        'article_type': article_type,
                        'article_length': article_length,
                    });
                },
                error: function () {
                }
            });
        }
    }

    //GA4 - 기자 구독 변경시
    function fn_setGoogleAnalyticsUserDetailsJPage(memUuid){
        $.ajax({
            url: '/google-analytics/user-details',
            type: 'POST',
            data: JSON.stringify({
                memUuid : memUuid
            }),
            contentType: 'application/json',
            success: function () {
            },
            error: function () {
            }
        });
    }
</script>
<!-- // endPage -->
</body>
</html>
